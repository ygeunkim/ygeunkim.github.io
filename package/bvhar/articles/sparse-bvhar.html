<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="bvhar">
<title>Sparse Priors • bvhar</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><link href="../deps/Noto_Sans-0.4.7/font.css" rel="stylesheet">
<link href="../deps/Anonymous_Pro-0.4.7/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Sparse Priors">
<meta property="og:description" content="bvhar">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">bvhar</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.14.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/bvhar.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/empirical-bayes.html">Empirical Bayes</a>
    <a class="dropdown-item" href="../articles/forecasting.html">Forecasting</a>
    <a class="dropdown-item" href="../articles/minnesota.html">Minnesota Prior</a>
    <a class="dropdown-item" href="../articles/sparse-bvhar.html">Sparse Priors</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ygeunkim/paper-bvhar" aria-label="Reproducible code">
    <span class="fa fa-laptop-code"></span>
     
    Reproducible code
  </a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ygeunkim/bvhar/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="..//software/" aria-label="Back to the page">
    <span class="fa fa-home"></span>
     
    Go back to the Software page
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Sparse Priors</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ygeunkim/bvhar/blob/HEAD/vignettes/sparse-bvhar.Rmd" class="external-link"><code>vignettes/sparse-bvhar.Rmd</code></a></small>
      <div class="d-none name"><code>sparse-bvhar.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ygeunkim/bvhar" class="external-link">bvhar</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Bayes plot---------</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/bayesplot/" class="external-link">bayesplot</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="stochastic-search-variable-selection-ssvs">Stochastic Search Variable Selection (SSVS)<a class="anchor" aria-label="anchor" href="#stochastic-search-variable-selection-ssvs"></a>
</h2>
<div class="section level3">
<h3 id="spike-and-slab">Spike-and-Slab<a class="anchor" aria-label="anchor" href="#spike-and-slab"></a>
</h3>
</div>
<div class="section level3">
<h3 id="ssvs">SSVS<a class="anchor" aria-label="anchor" href="#ssvs"></a>
</h3>
<div class="section level4">
<h4 id="default-semi-automatic-approach">Default semi-automatic approach<a class="anchor" aria-label="anchor" href="#default-semi-automatic-approach"></a>
</h4>
</div>
<div class="section level4">
<h4 id="covariance-shrinkage">Covariance shrinkage<a class="anchor" aria-label="anchor" href="#covariance-shrinkage"></a>
</h4>
<p><span class="math display">\[\Sigma^{-1} = \Psi
\Psi^\intercal\]</span></p>
<p>where <span class="math inline">\(\Psi\)</span> is an upper
triangular matrix. Shrinking <span class="math inline">\(\Psi\)</span>
gives the parsimony of precision matrix <span class="math inline">\(\Sigma^{-1}\)</span>.</p>
</div>
</div>
<div class="section level3">
<h3 id="example-1-of-george-et-al--2008">Example 1 of George et al. (2008)<a class="anchor" aria-label="anchor" href="#example-1-of-george-et-al--2008"></a>
</h3>
<div class="section level4">
<h4 id="var-simulation">VAR simulation<a class="anchor" aria-label="anchor" href="#var-simulation"></a>
</h4>
<p>6 variable VAR(1) with VAR coefficient <span class="math inline">\(\mathbb{A}\)</span>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">var_coef</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0L</span>, nrow <span class="op">=</span> <span class="fl">7</span>, ncol <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">var_coef</span><span class="op">[</span><span class="op">-</span><span class="fl">7</span>,<span class="op">]</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="co"># diag(var_coef[-7,]) &lt;- .9</span></span>
<span><span class="va">var_coef</span><span class="op">[</span><span class="fl">7</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">var_coef</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5] [,6]</span></span>
<span><span class="co">#&gt; [1,]    1    0    0    0    0    0</span></span>
<span><span class="co">#&gt; [2,]    0    1    0    0    0    0</span></span>
<span><span class="co">#&gt; [3,]    0    0    1    0    0    0</span></span>
<span><span class="co">#&gt; [4,]    0    0    0    1    0    0</span></span>
<span><span class="co">#&gt; [5,]    0    0    0    0    1    0</span></span>
<span><span class="co">#&gt; [6,]    0    0    0    0    0    1</span></span>
<span><span class="co">#&gt; [7,]    1    1    1    1    1    1</span></span></code></pre></div>
<p>and Choleksy factor <span class="math inline">\(\Psi\)</span>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Psi-------------------------------------</span></span>
<span><span class="va">var_chol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">6</span><span class="op">)</span></span>
<span><span class="va">var_chol</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">.5</span></span>
<span><span class="va">var_chol</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5] [,6]</span></span>
<span><span class="co">#&gt; [1,]    1  0.5  0.5  0.5  0.5  0.5</span></span>
<span><span class="co">#&gt; [2,]    0  1.0  0.0  0.0  0.0  0.0</span></span>
<span><span class="co">#&gt; [3,]    0  0.0  1.0  0.0  0.0  0.0</span></span>
<span><span class="co">#&gt; [4,]    0  0.0  0.0  1.0  0.0  0.0</span></span>
<span><span class="co">#&gt; [5,]    0  0.0  0.0  0.0  1.0  0.0</span></span>
<span><span class="co">#&gt; [6,]    0  0.0  0.0  0.0  0.0  1.0</span></span></code></pre></div>
<p>Note that the variance matrix for simulation is <span class="math inline">\(\Sigma_e = (\Psi
\Psi^\intercal)^{-1}\)</span>.</p>
<ul>
<li>MC simulation: 100 Samples of Size <span class="math inline">\(T =
50\)</span>.
<ul>
<li>In this vignette, we only generate 1 sample, not MC simulation.</li>
<li>This is because our goal is to show how the functions work, not
reproduce the paper exactly.</li>
</ul>
</li>
<li>Following Appendix D.1 of Helmut (2008), we compute the square root
of multivariate normal distribution variance matrix by Cholesky
decomposition.</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">var_data</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/sim_var.html">sim_var</a></span><span class="op">(</span></span>
<span>    num_sim <span class="op">=</span> <span class="fl">100</span>,</span>
<span>    num_burn <span class="op">=</span> <span class="fl">50</span>,</span>
<span>    var_coef <span class="op">=</span> <span class="va">var_coef</span>,</span>
<span>    var_lag <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    sig_error <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">var_chol</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">var_chol</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">var_coef</span><span class="op">)</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">1</span>, ncol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">var_coef</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"chol"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">var_data</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"y"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="ssvs-spec">SSVS spec<a class="anchor" aria-label="anchor" href="#ssvs-spec"></a>
</h4>
<p><code><a href="../reference/set_ssvs.html">set_ssvs()</a></code> specifies SSVS input.</p>
<ul>
<li>
<code>coef_spike</code>: <span class="math inline">\(\tau_{0i} =
0.1\)</span>
</li>
<li>
<code>coef_slab</code>: <span class="math inline">\(\tau_{1i} =
5\)</span>
<ul>
<li>For semi-automatic approach to <span class="math inline">\((\tau_{0i}, \tau_{1i})\)</span>, see the related
work such as George et al. (2008)</li>
</ul>
</li>
<li>
<code>coef_mixture</code>: <span class="math inline">\(p_j =
0.5\)</span>
<ul>
<li>noninformative</li>
<li>equally likely to be included as excluded</li>
</ul>
</li>
<li>
<code>shape</code>: <span class="math inline">\(a_j =
0.01\)</span>
</li>
<li>
<code>rate</code>: <span class="math inline">\(b_j = 0.01\)</span>
<ul>
<li>absence of prior information about <span class="math inline">\(\psi_{jj}\)</span>
</li>
<li>make the prior noninfluential with the hyperparameters <span class="math inline">\((a_j, b_j)\)</span> set to small values</li>
</ul>
</li>
<li>
<code>chol_spike</code>: <span class="math inline">\(\kappa_{0ij} =
0.1\)</span>
</li>
<li>
<code>chol_slab</code>: <span class="math inline">\(\kappa_{1ij} =
5\)</span>
<ul>
<li>For semi-automatic approach to <span class="math inline">\((\kappa_{0ij}, \kappa_{1ij})\)</span>, see the
related work such as George et al. (2008)</li>
</ul>
</li>
<li>
<code>chol_mixture</code>: <span class="math inline">\(q_{ij} =
0.5\)</span>
<ul>
<li>noninformative</li>
<li>equally likely to be included as excluded</li>
</ul>
</li>
</ul>
<p>As every hyperparameter has set to be the same for every <span class="math inline">\(i,j\)</span>, value can be assigned as numeric
value of length one. If you want to assign individually, you can use
vector. On the other hand, you can use upper triangular matrix for
<code>chol_spike</code>, <code>chol_slab</code>, and
<code>chol_mixture</code>.</p>
<!-- ```{r paramset} -->
<!-- (ssvs_spec <- set_ssvs( -->
<!--   coef_spike = .1, -->
<!--   coef_slab = 5, -->
<!--   coef_mixture = .5, -->
<!--   sd_non = 5, -->
<!--   shape = .01, -->
<!--   rate = .01, -->
<!--   chol_spike = .1, -->
<!--   chol_slab = 5, -->
<!--   chol_mixture = .5 -->
<!-- )) -->
<!-- ``` -->
<p>Before starting MCMC, set initial values. <code><a href="../reference/init_ssvs.html">init_ssvs()</a></code>
sets initial values for each parameter. Since George et al. (2008) did
not mention how they specify the starting points, we initialize as
follows. If the initial values are set close to posterior modes, MCMC is
known to be converged fast. Since Geoge et al. (2008) has already
provides the average of posterior mean over 100 sample, we use them as
initial points.</p>
<ul>
<li>
<code>init_coef</code>: initial <span class="math inline">\(\mathbb{A}= 0_{(kp + 1) \times k}\)</span>, k = 6,
p = 1</li>
<li>
<code>init_coef_dummy</code>: initial <span class="math inline">\(\Gamma = 1_{kp \times k}\)</span>, k = 6, p =
1</li>
<li>
<code>init_chol</code>: initial <span class="math inline">\(\Psi =
0_{k \times \times}\)</span> k = 6</li>
<li>
<code>init_chol_dummy</code>: initial <span class="math inline">\(\Omega =\)</span> upper triangular matrix of which
every diagonal and upper diagonal element is 1.</li>
</ul>
<!-- ```{r initset} --><!-- # average posterior means of parameters------- --><!-- init_coef <- matrix(c( --><!--   .87, .06, .07, .06, .07, .06, --><!--   .03, .80, .03, .04, .02, .04, --><!--   .02, .04, .81, .04, .04, .03, --><!--   .02, .03, .03, .80, .03, .04, --><!--   .03, .03, .03, .03, .81, .03, --><!--   .02, .04, .03, .03, .03, .79 --><!-- ), nrow = 6, byrow = TRUE) --><!-- init_coef_dummy <- matrix(c( --><!--   1.00, .04, rep(.05, 4), --><!--   .04, 1.00, rep(.04, 4), --><!--   .04, .05, 1.00, .05, .04, .04, --><!--   rep(.04, 3), 1.00, .04, .05, --><!--   rep(.04, 4), 1.00, .04, --><!--   rep(.04, 5), 1.00 --><!-- ), nrow = 6, byrow = TRUE) --><!-- init_chol <- matrix(0L, nrow = 6L, ncol = 6L) --><!-- diag(init_chol) <- c(1.09, 1.08, 1.08, 1.11, 1.10, 1.10) --><!-- init_chol[upper.tri(init_chol, diag = FALSE)] <- c( --><!--   .42, --><!--   .40, -.04, --><!--   .41, rep(-.03, 2), --><!--   .39, rep(-.03, 3), --><!--   .38, -.04, -.03, rep(-.04, 2) --><!-- ) --><!-- init_omega <- matrix(0L, nrow = 6L, ncol = 6L) --><!-- diag(init_omega) <- 1 --><!-- init_omega[upper.tri(init_omega, diag = FALSE)] <- c( --><!--   .58, --><!--   .55, .08, --><!--   .53, .08, .07, --><!--   .52, .07, rep(.08, 2), --><!--   .50, rep(.08, 2), .10, .09 --><!-- ) --><!-- # initial values specification----------------- --><!-- (init_spec <- init_ssvs( --><!--   init_coef = init_coef, --><!--   init_coef_dummy = init_coef_dummy, --><!--   init_chol = init_chol, --><!--   init_chol_dummy = init_omega --><!-- )) --><!-- ``` --><p>Luckily, the package provides automatic process for both
hyperparameter specification and initial value selection.</p>
<ul>
<li>
<code>choose_ssvs(y, ord, type, include_mean, gamma_param, mean_non, sd_non)</code>:
A default semiautomatic approach</li>
<li>
<code>init_ssvs(type = "auto")</code>: Use OLS for coefficients and
1 for indicators.</li>
</ul>
</div>
<div class="section level4">
<h4 id="gibbs-sampling">Gibbs sampling<a class="anchor" aria-label="anchor" href="#gibbs-sampling"></a>
</h4>
<p><code><a href="../reference/bvar_ssvs.html">bvar_ssvs()</a></code> performs SSVS for VAR model.</p>
<ul>
<li>
<code>y</code>: data</li>
<li>
<code>p</code>: order</li>
<li>
<code>num_iter</code>: Total number of iteration (including
burn-in)</li>
<li>
<code>num_burn</code>: The number of burn-in (warm-up)</li>
<li>
<code>thinning</code>: Thinning</li>
<li>
<code>bayes_spec</code>: SSVS specification using
<code><a href="../reference/set_ssvs.html">set_ssvs()</a></code>.</li>
<li>
<code>init_spec</code>: SSVS initialization specification using
<code><a href="../reference/init_ssvs.html">init_ssvs()</a></code>.</li>
<li>
<code>include_mean</code>: whether including the constant term in
the model.</li>
<li>
<code>verbose</code>: whether to display the progress bar.</li>
</ul>
<p>If each <code>bayes_spec</code> and <code>init_spec</code> is not
specified, corresponding automatic approach is performed.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">var_ssvs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bvar_ssvs.html">bvar_ssvs</a></span><span class="op">(</span></span>
<span>  y <span class="op">=</span> <span class="va">var_data</span>,</span>
<span>  p <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  num_iter <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  num_burn <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  thinning <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  include_mean <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; bvar_ssvs(y = var_data, p = 1, num_iter = 1000, num_burn = 500, </span></span>
<span><span class="co">#&gt;     thinning = 1, include_mean = FALSE, verbose = FALSE)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; BVAR(1) with SSVS Prior</span></span>
<span><span class="co">#&gt; Fitted by Gibbs sampling</span></span>
<span><span class="co">#&gt; Total number of iteration: 1000</span></span>
<span><span class="co">#&gt; Number of burn-in: 500</span></span>
<span><span class="co">#&gt; ====================================================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter Record:</span></span>
<span><span class="co">#&gt; # A draws_df: 500 iterations, 1 chains, and 108 variables</span></span>
<span><span class="co">#&gt;     alpha[1]  alpha[2]   alpha[3]   alpha[4]   alpha[5]   alpha[6]  alpha[7]</span></span>
<span><span class="co">#&gt; 1       1.01  -0.01032   0.000823   0.005289   0.003256  -4.41e-05    0.0855</span></span>
<span><span class="co">#&gt; 2       1.01   0.00306  -0.003958   0.007283  -0.006203   1.60e-03    0.0968</span></span>
<span><span class="co">#&gt; 3       1.00   0.00578  -0.004024   0.000296  -0.000731   5.73e-03    0.0740</span></span>
<span><span class="co">#&gt; 4       1.01  -0.00759   0.004900  -0.003924  -0.002697   2.63e-03    0.0740</span></span>
<span><span class="co">#&gt; 5       1.02  -0.00905  -0.002120  -0.001431   0.001932   2.01e-03    0.0768</span></span>
<span><span class="co">#&gt; 6       1.01  -0.00538   0.003921  -0.000946   0.005896  -4.18e-03    0.0909</span></span>
<span><span class="co">#&gt; 7       1.01  -0.00605  -0.003565   0.003743   0.001345   6.38e-03    0.0388</span></span>
<span><span class="co">#&gt; 8       1.02  -0.00199  -0.003802  -0.004839  -0.005370  -1.03e-03    0.0867</span></span>
<span><span class="co">#&gt; 9       1.02   0.00432  -0.002390   0.005107   0.000528  -2.27e-02    0.0568</span></span>
<span><span class="co">#&gt; 10      1.01   0.00300  -0.000486   0.006204  -0.002637  -5.88e-03    0.0893</span></span>
<span><span class="co">#&gt;     alpha[8]</span></span>
<span><span class="co">#&gt; 1      0.934</span></span>
<span><span class="co">#&gt; 2      0.924</span></span>
<span><span class="co">#&gt; 3      0.920</span></span>
<span><span class="co">#&gt; 4      0.931</span></span>
<span><span class="co">#&gt; 5      0.930</span></span>
<span><span class="co">#&gt; 6      0.926</span></span>
<span><span class="co">#&gt; 7      0.971</span></span>
<span><span class="co">#&gt; 8      0.912</span></span>
<span><span class="co">#&gt; 9      0.958</span></span>
<span><span class="co">#&gt; 10     0.900</span></span>
<span><span class="co">#&gt; # ... with 490 more draws, and 100 more variables</span></span>
<span><span class="co">#&gt; # ... hidden reserved variables {'.chain', '.iteration', '.draw'}</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="plots-for-mcmc">Plots for MCMC<a class="anchor" aria-label="anchor" href="#plots-for-mcmc"></a>
</h3>
<p>Since each parameter element is <code><a href="https://mc-stan.org/posterior/reference/draws_df.html" class="external-link">posterior::draws_df</a></code>
format, <code>bayesplot</code> package is applicable.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/bayesplot-colors.html" class="external-link">color_scheme_set</a></span><span class="op">(</span><span class="st">"blue"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">var_ssvs</span>, type <span class="op">=</span> <span class="st">"trace"</span>, regex_pars <span class="op">=</span> <span class="st">"psi"</span><span class="op">)</span></span></code></pre></div>
<p><img src="sparse-bvhar_files/figure-html/psiplot-1.png" width="70%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">var_ssvs</span>, type <span class="op">=</span> <span class="st">"dens"</span>, pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"alpha[1]"</span>, <span class="st">"alpha[2]"</span>, <span class="st">"alpha[9]"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="sparse-bvhar_files/figure-html/alphadens-1.png" width="70%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="ssvs-for-vhar-model">SSVS for VHAR Model<a class="anchor" aria-label="anchor" href="#ssvs-for-vhar-model"></a>
</h3>
<!-- 6 variable VHAR: -->
<!-- ```{r initvhar} -->
<!-- # Upper triangular matrix---------------------- -->
<!-- initvhar_chol <- matrix(0L, nrow = 6L, ncol = 6L) -->
<!-- diag(initvhar_chol) <- .1 -->
<!-- initvhar_omega <- matrix(1L, nrow = 6L, ncol = 6L) -->
<!-- initvhar_omega[lower.tri(initvhar_omega, diag = TRUE)] <- 0L -->
<!-- # initial values specification----------------- -->
<!-- (initvhar_spec <- init_ssvs( -->
<!--   init_coef = matrix(0L, nrow = 19L, ncol = 6L), -->
<!--   init_coef_dummy = matrix(1L, nrow = 18L, ncol = 6L), -->
<!--   init_chol = initvhar_chol, -->
<!--   init_chol_dummy = initvhar_omega -->
<!-- )) -->
<!-- ``` -->
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">vhar_ssvs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bvhar_ssvs.html">bvhar_ssvs</a></span><span class="op">(</span></span>
<span>  y <span class="op">=</span> <span class="va">var_data</span>,</span>
<span>  har <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">22</span><span class="op">)</span>,</span>
<span>  num_iter <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  num_burn <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  thinning <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  include_mean <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; bvhar_ssvs(y = var_data, har = c(5, 22), num_iter = 1000, num_burn = 500, </span></span>
<span><span class="co">#&gt;     thinning = 1, include_mean = FALSE, verbose = FALSE)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; BVHAR with SSVS Prior</span></span>
<span><span class="co">#&gt; Fitted by Gibbs sampling</span></span>
<span><span class="co">#&gt; Total number of iteration: 1000</span></span>
<span><span class="co">#&gt; Number of burn-in: 500</span></span>
<span><span class="co">#&gt; ====================================================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter Record:</span></span>
<span><span class="co">#&gt; # A draws_df: 500 iterations, 1 chains, and 252 variables</span></span>
<span><span class="co">#&gt;     phi[1]    phi[2]    phi[3]    phi[4]    phi[5]    phi[6]    phi[7]</span></span>
<span><span class="co">#&gt; 1    0.935   0.01226   0.00875   0.12249  -0.01183   0.00738  -0.01589</span></span>
<span><span class="co">#&gt; 2    0.860   0.00857  -0.01411   0.02716  -0.02022   0.00527  -0.00397</span></span>
<span><span class="co">#&gt; 3    0.995   0.00313  -0.00146   0.02234  -0.01628   0.01029  -0.00935</span></span>
<span><span class="co">#&gt; 4    0.861   0.00938   0.01780   0.00815   0.00585  -0.00803   0.00184</span></span>
<span><span class="co">#&gt; 5    0.973   0.00351   0.00221   0.01001   0.02041   0.00683  -0.01892</span></span>
<span><span class="co">#&gt; 6    0.822  -0.00223  -0.00649   0.00159   0.00566  -0.00883   0.01514</span></span>
<span><span class="co">#&gt; 7    0.960   0.00957   0.00203  -0.00951   0.01169   0.00155   0.02089</span></span>
<span><span class="co">#&gt; 8    0.908   0.00105   0.00272   0.07226   0.02618  -0.01376   0.06130</span></span>
<span><span class="co">#&gt; 9    0.847  -0.00192  -0.01248   0.13740   0.00533  -0.00192   0.01353</span></span>
<span><span class="co">#&gt; 10   0.933   0.00669  -0.00764   0.06753  -0.01287   0.00672   0.01113</span></span>
<span><span class="co">#&gt;       phi[8]</span></span>
<span><span class="co">#&gt; 1    0.01704</span></span>
<span><span class="co">#&gt; 2   -0.01594</span></span>
<span><span class="co">#&gt; 3    0.03540</span></span>
<span><span class="co">#&gt; 4   -0.05157</span></span>
<span><span class="co">#&gt; 5    0.02760</span></span>
<span><span class="co">#&gt; 6    0.05536</span></span>
<span><span class="co">#&gt; 7   -0.00459</span></span>
<span><span class="co">#&gt; 8    0.01702</span></span>
<span><span class="co">#&gt; 9   -0.03166</span></span>
<span><span class="co">#&gt; 10   0.01266</span></span>
<span><span class="co">#&gt; # ... with 490 more draws, and 244 more variables</span></span>
<span><span class="co">#&gt; # ... hidden reserved variables {'.chain', '.iteration', '.draw'}</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Young Geun Kim.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
