<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to bvhar • bvhar</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Noto_Sans-0.4.9/font.css" rel="stylesheet">
<link href="../deps/Anonymous_Pro-0.4.9/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to bvhar">
<meta name="robots" content="noindex">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bvhar</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">2.0.1.9015</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/bvhar.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/forecasting.html">Forecasting</a></li>
    <li><a class="dropdown-item" href="../articles/linking.html">Cpp source usage</a></li>
    <li><a class="dropdown-item" href="../articles/minnesota.html">Minnesota Prior</a></li>
    <li><a class="dropdown-item" href="../articles/shrinkage.html">Shrinkage Priors</a></li>
    <li><a class="dropdown-item" href="../articles/stochastic-volatility.html">Stochastic Volatility Models</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news">
<li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://github.com/ygeunkim/bvhar/releases/tag/v0.9.0">JSCS submission ver</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/ygeunkim/bvhar/releases/tag/v0.12.0">JSCS revision ver</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/ygeunkim/bvhar/releases/tag/v1.2.0">Version 1.2.0</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/ygeunkim/bvhar/releases/tag/v2.0.1">Version 2.0.1</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul>
</li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ygeunkim/paper-bvhar" aria-label="Reproducible code"><span class="fa fa-laptop-code"></span> Reproducible code</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ygeunkim/bvhar/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item"><a class="nav-link" href="..//software/" aria-label="Back to the page"><span class="fa fa-home"></span> Go back to the Software page</a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Introduction to bvhar</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ygeunkim/bvhar/blob/develop/vignettes/bvhar.Rmd" class="external-link"><code>vignettes/bvhar.Rmd</code></a></small>
      <div class="d-none name"><code>bvhar.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ygeunkim.github.io/package/bvhar/" class="external-link">bvhar</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h2>
<p>Looking at VAR and VHAR, you can learn how the models work and how to
perform this package.</p>
<div class="section level3">
<h3 id="etf-dataset">ETF Dataset<a class="anchor" aria-label="anchor" href="#etf-dataset"></a>
</h3>
<p>This package includes some datasets. Among them, we try CBOE ETF
volatility index (<code>etf_vix</code>). Since this is just an example,
we arbitrarily extract a small number of variables: <em>Gold, crude oil,
euro currency, and china ETF</em>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">var_idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GVZCLS"</span>, <span class="st">"OVXCLS"</span>, <span class="st">"EVZCLS"</span>, <span class="st">"VXFXICLS"</span><span class="op">)</span></span>
<span><span class="va">etf</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">etf_vix</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">all_of</a></span><span class="op">(</span><span class="va">var_idx</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">etf</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 905 × 4</span></span></span>
<span><span class="co">#&gt;    GVZCLS OVXCLS EVZCLS VXFXICLS</span></span>
<span><span class="co">#&gt;     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>   21.5   36.5   13.2     30.2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>   21.5   35.4   12.6     28.9</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>   22.3   35.5   13.1     29.1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>   21.6   36.6   12.8     28.5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>   21.2   35.6   13.3     29.5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>   21.4   34.8   13.2     29.1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>   21.6   34.0   13.2     28.7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>   21.1   32.6   12.8     28.0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>   20.3   33.5   12.7     28.9</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>   19.6   33.4   12.4     28.0</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 895 more rows</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="h-step-ahead-forecasting">h-step ahead forecasting<a class="anchor" aria-label="anchor" href="#h-step-ahead-forecasting"></a>
</h3>
<p>For evaluation, split the data. The last <code>19</code> observations
will be test set. <code><a href="../reference/divide_ts.html">divide_ts()</a></code> function splits the time
series into train-test set.</p>
<p>In the other vignette, we provide how to perform out-of-sample
forecasting.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">h</span> <span class="op">&lt;-</span> <span class="fl">19</span></span>
<span><span class="va">etf_eval</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/divide_ts.html">divide_ts</a></span><span class="op">(</span><span class="va">etf</span>, <span class="va">h</span><span class="op">)</span> <span class="co"># Try ?divide_ts</span></span>
<span><span class="va">etf_train</span> <span class="op">&lt;-</span> <span class="va">etf_eval</span><span class="op">$</span><span class="va">train</span> <span class="co"># train</span></span>
<span><span class="va">etf_test</span> <span class="op">&lt;-</span> <span class="va">etf_eval</span><span class="op">$</span><span class="va">test</span> <span class="co"># test</span></span>
<span><span class="co"># dimension---------</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">etf</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>T: Total number of observation</li>
<li>p: VAR lag</li>
<li>m: Dimension of variable</li>
<li>s = T - p</li>
<li>k = m * p + 1 if constant term, k = m * p without constant term</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="models">Models<a class="anchor" aria-label="anchor" href="#models"></a>
</h2>
<div class="section level3">
<h3 id="var">VAR<a class="anchor" aria-label="anchor" href="#var"></a>
</h3>
<p>This package indentifies VAR(p) model by</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>𝐘</mi><mi>t</mi></msub><mo>=</mo><mi>𝐜</mi><mo>+</mo><msub><mi>𝛃</mi><mn>1</mn></msub><msub><mi>𝐘</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>…</mi><mo>+</mo><msub><mi>𝛃</mi><mi>p</mi></msub><mo>+</mo><msub><mi>𝐘</mi><mrow><mi>t</mi><mo>−</mo><mi>p</mi></mrow></msub><mo>+</mo><msub><mi>𝛜</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\mathbf{Y}_t = \mathbf{c}+ \boldsymbol\beta_1 \mathbf{Y}_{t - 1} + \ldots + \boldsymbol\beta_p +\mathbf{Y}_{t - p} + \boldsymbol\epsilon_t</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>𝛜</mi><mi>t</mi></msub><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mn>𝟎</mn><mi>k</mi></msub><mo>,</mo><msub><mi>Σ</mi><mi>e</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\boldsymbol\epsilon_t \sim N(\mathbf{0}_k, \Sigma_e)</annotation></semantics></math></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">var_lag</span> <span class="op">&lt;-</span> <span class="fl">5</span></span></code></pre></div>
<p>The package perform VAR(p = 5) based on</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mn>0</mn></msub><mo>=</mo><msub><mi>X</mi><mn>0</mn></msub><mi>A</mi><mo>+</mo><mi>Z</mi></mrow><annotation encoding="application/x-tex">Y_0 = X_0 A + Z</annotation></semantics></math></p>
<p>where</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mn>0</mn></msub><mo>=</mo><msub><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>𝐲</mi><mrow><mi>p</mi><mo>+</mo><mn>1</mn></mrow><mi>T</mi></msubsup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>𝐲</mi><mrow><mi>p</mi><mo>+</mo><mn>2</mn></mrow><mi>T</mi></msubsup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>⋮</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>𝐲</mi><mi>n</mi><mi>T</mi></msubsup></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow><mrow><mi>s</mi><mo>×</mo><mi>m</mi></mrow></msub><mo>≡</mo><msub><mi>Y</mi><mrow><mi>p</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>∈</mo><msup><mi>ℝ</mi><mrow><mi>s</mi><mo>×</mo><mi>m</mi></mrow></msup></mrow><annotation encoding="application/x-tex">
Y_0 = \begin{bmatrix}
  \mathbf{y}_{p + 1}^T \\
  \mathbf{y}_{p + 2}^T \\
  \vdots \\
  \mathbf{y}_n^T
\end{bmatrix}_{s \times m} \equiv Y_{p + 1} \in \mathbb{R}^{s \times m}
</annotation></semantics></math></p>
<p>by <code>build_y0()</code></p>
<p>and</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mn>0</mn></msub><mo>=</mo><msub><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>𝐲</mi><mi>p</mi><mi>T</mi></msubsup></mtd><mtd columnalign="center" style="text-align: center"><mi>⋯</mi></mtd><mtd columnalign="center" style="text-align: center"><msubsup><mi>𝐲</mi><mn>1</mn><mi>T</mi></msubsup></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>𝐲</mi><mrow><mi>p</mi><mo>+</mo><mn>1</mn></mrow><mi>T</mi></msubsup></mtd><mtd columnalign="center" style="text-align: center"><mi>⋯</mi></mtd><mtd columnalign="center" style="text-align: center"><msubsup><mi>𝐲</mi><mn>2</mn><mi>T</mi></msubsup></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>⋮</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>⋮</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>⋯</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>⋮</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>𝐲</mi><mrow><mi>T</mi><mo>−</mo><mn>1</mn></mrow><mi>T</mi></msubsup></mtd><mtd columnalign="center" style="text-align: center"><mi>⋯</mi></mtd><mtd columnalign="center" style="text-align: center"><msubsup><mi>𝐲</mi><mrow><mi>T</mi><mo>−</mo><mi>p</mi></mrow><mi>T</mi></msubsup></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow><mrow><mi>s</mi><mo>×</mo><mi>k</mi></mrow></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>Y</mi><mi>p</mi></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>Y</mi><mrow><mi>p</mi><mo>−</mo><mn>1</mn></mrow></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>⋯</mi></mtd><mtd columnalign="center" style="text-align: center"><msub><mn>𝟏</mn><mrow><mi>T</mi><mo>−</mo><mi>p</mi></mrow></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow><mo>∈</mo><msup><mi>ℝ</mi><mrow><mi>s</mi><mo>×</mo><mi>k</mi></mrow></msup></mrow><annotation encoding="application/x-tex">
X_0 = \left[\begin{array}{c|c|c|c}
  \mathbf{y}_p^T &amp; \cdots &amp; \mathbf{y}_1^T &amp; 1 \\
  \mathbf{y}_{p + 1}^T &amp; \cdots &amp; \mathbf{y}_2^T &amp; 1 \\
  \vdots &amp; \vdots &amp; \cdots &amp; \vdots \\
  \mathbf{y}_{T - 1}^T &amp; \cdots &amp; \mathbf{y}_{T - p}^T &amp; 1
\end{array}\right]_{s \times k} = \begin{bmatrix}
  Y_p &amp; Y_{p - 1} &amp; \cdots &amp; \mathbf{1}_{T - p}
\end{bmatrix} \in \mathbb{R}^{s \times k}
</annotation></semantics></math></p>
<p>by <code>build_design()</code>. Coefficient matrix is the form of</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>A</mi><mn>1</mn><mi>T</mi></msubsup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>⋮</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>A</mi><mi>p</mi><mi>T</mi></msubsup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msup><mi>𝐜</mi><mi>T</mi></msup></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow><mo>∈</mo><msup><mi>ℝ</mi><mrow><mi>k</mi><mo>×</mo><mi>m</mi></mrow></msup></mrow><annotation encoding="application/x-tex">
A = \begin{bmatrix}
  A_1^T \\
  \vdots \\
  A_p^T \\
  \mathbf{c}^T
\end{bmatrix} \in \mathbb{R}^{k \times m}
</annotation></semantics></math></p>
<p>This form also corresponds to the other model. Use
<code>var_lm(y, p)</code> to model VAR(p). You can specify
<code>type = "none"</code> to get model without constant term.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">fit_var</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/var_lm.html">var_lm</a></span><span class="op">(</span><span class="va">etf_train</span>, <span class="va">var_lag</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; var_lm(y = etf_train, p = var_lag)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; VAR(5) Estimation using least squares</span></span>
<span><span class="co">#&gt; ====================================================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; LSE for A1:</span></span>
<span><span class="co">#&gt;           GVZCLS_1  OVXCLS_1  EVZCLS_1  VXFXICLS_1</span></span>
<span><span class="co">#&gt; GVZCLS     0.93290    0.0545    0.0659     -0.0346</span></span>
<span><span class="co">#&gt; OVXCLS    -0.02367    1.0047   -0.1447      0.0324</span></span>
<span><span class="co">#&gt; EVZCLS    -0.00789    0.0102    0.9810      0.0199</span></span>
<span><span class="co">#&gt; VXFXICLS  -0.03868    0.0109    0.0754      0.9328</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; LSE for A2:</span></span>
<span><span class="co">#&gt;           GVZCLS_2  OVXCLS_2  EVZCLS_2  VXFXICLS_2</span></span>
<span><span class="co">#&gt; GVZCLS     -0.0781  -0.04865    0.0829      0.0561</span></span>
<span><span class="co">#&gt; OVXCLS      0.0880   0.01207    0.2729     -0.1173</span></span>
<span><span class="co">#&gt; EVZCLS      0.0195   0.00255   -0.1071     -0.0383</span></span>
<span><span class="co">#&gt; VXFXICLS    0.0896   0.04278   -0.0691      0.0419</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; LSE for A3:</span></span>
<span><span class="co">#&gt;           GVZCLS_3  OVXCLS_3  EVZCLS_3  VXFXICLS_3</span></span>
<span><span class="co">#&gt; GVZCLS      0.0424  -0.00452  -0.03245    -0.05967</span></span>
<span><span class="co">#&gt; OVXCLS     -0.0272  -0.09144  -0.05764    -0.06255</span></span>
<span><span class="co">#&gt; EVZCLS     -0.0123   0.00864   0.08693     0.00252</span></span>
<span><span class="co">#&gt; VXFXICLS   -0.0266  -0.04810   0.00851    -0.02137</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; LSE for A4:</span></span>
<span><span class="co">#&gt;           GVZCLS_4  OVXCLS_4  EVZCLS_4  VXFXICLS_4</span></span>
<span><span class="co">#&gt; GVZCLS    -0.00793   0.01072  -0.01513      0.0616</span></span>
<span><span class="co">#&gt; OVXCLS    -0.04343  -0.00377  -0.00694      0.1445</span></span>
<span><span class="co">#&gt; EVZCLS     0.00614  -0.02278  -0.01007      0.0200</span></span>
<span><span class="co">#&gt; VXFXICLS  -0.00755  -0.05555   0.08783     -0.1025</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; LSE for A5:</span></span>
<span><span class="co">#&gt;           GVZCLS_5  OVXCLS_5  EVZCLS_5  VXFXICLS_5</span></span>
<span><span class="co">#&gt; GVZCLS      0.0728  -0.01745   -0.0886   -0.017273</span></span>
<span><span class="co">#&gt; OVXCLS      0.0104   0.07151   -0.0637    0.002018</span></span>
<span><span class="co">#&gt; EVZCLS     -0.0113   0.00581    0.0202    0.000498</span></span>
<span><span class="co">#&gt; VXFXICLS   -0.0155   0.04192   -0.0254    0.093984</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; LSE for constant:</span></span>
<span><span class="co">#&gt;   GVZCLS    OVXCLS    EVZCLS  VXFXICLS  </span></span>
<span><span class="co">#&gt;    0.571     0.145     0.129     0.875  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --------------------------------------------------</span></span>
<span><span class="co">#&gt; *_j of the Coefficient matrix: corresponding to the j-th VAR lag</span></span></code></pre></div>
<p>The package provide <code>S3</code> object.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># class---------------</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">fit_var</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "varlse"   "olsmod"   "bvharmod"</span></span>
<span><span class="co"># inheritance---------</span></span>
<span><span class="fu"><a href="../reference/var_lm.html">is.varlse</a></span><span class="op">(</span><span class="va">fit_var</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="co"># names---------------</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">fit_var</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "coefficients"  "fitted.values" "residuals"     "covmat"       </span></span>
<span><span class="co">#&gt;  [5] "df"            "m"             "obs"           "y0"           </span></span>
<span><span class="co">#&gt;  [9] "p"             "totobs"        "process"       "type"         </span></span>
<span><span class="co">#&gt; [13] "design"        "y"             "method"        "call"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="vhar">VHAR<a class="anchor" aria-label="anchor" href="#vhar"></a>
</h3>
<p>Consider Vector HAR (VHAR) model.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>𝐘</mi><mi>t</mi></msub><mo>=</mo><mi>𝐜</mi><mo>+</mo><msup><mi>Φ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>d</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo>+</mo><msub><mi>𝐘</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msup><mi>Φ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><msubsup><mi>𝐘</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>+</mo><msup><mi>Φ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><msubsup><mi>𝐘</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>+</mo><msub><mi>𝛜</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\mathbf{Y}_t = \mathbf{c}+ \Phi^{(d)} + \mathbf{Y}_{t - 1} + \Phi^{(w)} \mathbf{Y}_{t - 1}^{(w)} + \Phi^{(m)} \mathbf{Y}_{t - 1}^{(m)} + \boldsymbol\epsilon_t</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝐘</mi><mi>t</mi></msub><annotation encoding="application/x-tex">\mathbf{Y}_t</annotation></semantics></math>
is daily RV and</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>𝐘</mi><mi>t</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>=</mo><mfrac><mn>1</mn><mn>5</mn></mfrac><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝐘</mi><mi>t</mi></msub><mo>+</mo><mi>⋯</mi><mo>+</mo><msub><mi>𝐘</mi><mrow><mi>t</mi><mo>−</mo><mn>4</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbf{Y}_t^{(w)} = \frac{1}{5} \left( \mathbf{Y}_t + \cdots + \mathbf{Y}_{t - 4} \right)</annotation></semantics></math></p>
<p>is weekly RV</p>
<p>and</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>𝐘</mi><mi>t</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>=</mo><mfrac><mn>1</mn><mn>22</mn></mfrac><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝐘</mi><mi>t</mi></msub><mo>+</mo><mi>⋯</mi><mo>+</mo><msub><mi>𝐘</mi><mrow><mi>t</mi><mo>−</mo><mn>21</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbf{Y}_t^{(m)} = \frac{1}{22} \left( \mathbf{Y}_t + \cdots + \mathbf{Y}_{t - 21} \right)</annotation></semantics></math></p>
<p>is monthly RV. This model can be expressed by</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mn>0</mn></msub><mo>=</mo><msub><mi>X</mi><mn>1</mn></msub><mi>Φ</mi><mo>+</mo><mi>Z</mi></mrow><annotation encoding="application/x-tex">Y_0 = X_1 \Phi + Z</annotation></semantics></math></p>
<p>where</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Φ</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msup><mi>Φ</mi><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>d</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></mrow></msup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msup><mi>Φ</mi><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></mrow></msup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msup><mi>Φ</mi><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></mrow></msup></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msup><mi>𝐜</mi><mi>T</mi></msup></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow><mo>∈</mo><msup><mi>ℝ</mi><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>3</mn><mi>m</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>×</mo><mi>m</mi></mrow></msup></mrow><annotation encoding="application/x-tex">
\Phi = \begin{bmatrix}
  \Phi^{(d)T} \\
  \Phi^{(w)T} \\
  \Phi^{(m)T} \\
  \mathbf{c}^T
\end{bmatrix} \in \mathbb{R}^{(3m + 1) \times m}
</annotation></semantics></math></p>
<p>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>T</mi><annotation encoding="application/x-tex">T</annotation></semantics></math>
be</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ℂ</mi><mn>0</mn></msub><mo>:</mo><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>⋯</mi></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>⋯</mi></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>1</mn><mi>/</mi><mn>5</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn><mi>/</mi><mn>5</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>⋯</mi></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn><mi>/</mi><mn>5</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>⋯</mi></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>1</mn><mi>/</mi><mn>22</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn><mi>/</mi><mn>22</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>⋯</mi></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn><mi>/</mi><mn>22</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn><mi>/</mi><mn>22</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>⋯</mi></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn><mi>/</mi><mn>22</mn></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow><mo>⊗</mo><msub><mi>I</mi><mi>m</mi></msub><mo>∈</mo><msup><mi>ℝ</mi><mrow><mn>3</mn><mi>m</mi><mo>×</mo><mn>22</mn><mi>m</mi></mrow></msup></mrow><annotation encoding="application/x-tex">
\mathbb{C}_0 \mathpunct{:}=\begin{bmatrix}
  1 &amp; 0 &amp; \cdots &amp; 0 &amp; 0 &amp; \cdots &amp; 0 \\
  1 / 5 &amp; 1 / 5 &amp; \cdots &amp; 1 / 5 &amp; 0 &amp; \cdots &amp; 0 \\
  1 / 22 &amp; 1 / 22 &amp; \cdots &amp; 1 / 22 &amp; 1 / 22 &amp; \cdots &amp; 1 / 22
\end{bmatrix} \otimes I_m \in \mathbb{R}^{3m \times 22m}
</annotation></semantics></math></p>
<p>and let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ℂ</mi><mrow><mi>H</mi><mi>A</mi><mi>R</mi></mrow></msub><annotation encoding="application/x-tex">\mathbb{C}_{HAR}</annotation></semantics></math>
be</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ℂ</mi><mrow><mi>H</mi><mi>A</mi><mi>R</mi></mrow></msub><mo>:</mo><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mi>T</mi></mtd><mtd columnalign="center" style="text-align: center"><msub><mn>𝟎</mn><mrow><mn>3</mn><mi>m</mi></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mn>𝟎</mn><mrow><mn>3</mn><mi>m</mi></mrow><mi>T</mi></msubsup></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow><mo>∈</mo><msup><mi>ℝ</mi><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>3</mn><mi>m</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>×</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>22</mn><mi>m</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msup></mrow><annotation encoding="application/x-tex">
\mathbb{C}_{HAR} \mathpunct{:}=\left[\begin{array}{c|c}
  T &amp; \mathbf{0}_{3m} \\ \hline
  \mathbf{0}_{3m}^T &amp; 1
\end{array}\right] \in \mathbb{R}^{(3m + 1) \times (22m + 1)}
</annotation></semantics></math></p>
<p>Then for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mn>0</mn></msub><annotation encoding="application/x-tex">X_0</annotation></semantics></math>
in VAR(p),</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mn>1</mn></msub><mo>=</mo><msub><mi>X</mi><mn>0</mn></msub><msubsup><mi>ℂ</mi><mrow><mi>H</mi><mi>A</mi><mi>R</mi></mrow><mi>T</mi></msubsup><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>𝐲</mi><mn>22</mn><mi>T</mi></msubsup></mtd><mtd columnalign="center" style="text-align: center"><msubsup><mi>𝐲</mi><mn>22</mn><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></mrow></msubsup></mtd><mtd columnalign="center" style="text-align: center"><msubsup><mi>𝐲</mi><mn>22</mn><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></mrow></msubsup></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>𝐲</mi><mn>23</mn><mi>T</mi></msubsup></mtd><mtd columnalign="center" style="text-align: center"><msubsup><mi>𝐲</mi><mn>23</mn><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></mrow></msubsup></mtd><mtd columnalign="center" style="text-align: center"><msubsup><mi>𝐲</mi><mn>23</mn><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></mrow></msubsup></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>⋮</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>⋮</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>⋮</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>⋮</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>𝐲</mi><mrow><mi>T</mi><mo>−</mo><mn>1</mn></mrow><mi>T</mi></msubsup></mtd><mtd columnalign="center" style="text-align: center"><msubsup><mi>𝐲</mi><mrow><mi>T</mi><mo>−</mo><mn>1</mn></mrow><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></mrow></msubsup></mtd><mtd columnalign="center" style="text-align: center"><msubsup><mi>𝐲</mi><mrow><mi>T</mi><mo>−</mo><mn>1</mn></mrow><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></mrow></msubsup></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow><mo>∈</mo><msup><mi>ℝ</mi><mrow><mi>s</mi><mo>×</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>3</mn><mi>m</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msup></mrow><annotation encoding="application/x-tex">
X_1 = X_0 \mathbb{C}_{HAR}^T = \begin{bmatrix}
  \mathbf{y}_{22}^T &amp; \mathbf{y}_{22}^{(w)T} &amp; \mathbf{y}_{22}^{(m)T} &amp; 1 \\
  \mathbf{y}_{23}^T &amp; \mathbf{y}_{23}^{(w)T} &amp; \mathbf{y}_{23}^{(m)T} &amp; 1 \\
  \vdots &amp; \vdots &amp; \vdots &amp; \vdots \\
  \mathbf{y}_{T - 1}^T &amp; \mathbf{y}_{T - 1}^{(w)T} &amp; \mathbf{y}_{T - 1}^{(m)T} &amp; 1
\end{bmatrix} \in \mathbb{R}^{s \times (3m + 1)}
</annotation></semantics></math></p>
<p>This package fits VHAR by scaling VAR(p) using
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ℂ</mi><mrow><mi>H</mi><mi>A</mi><mi>R</mi></mrow></msub><annotation encoding="application/x-tex">\mathbb{C}_{HAR}</annotation></semantics></math>
(<code>scale_har(m, week = 5, month = 22)</code>). Use
<code>vhar_lm(y)</code> to fit VHAR. You can specify
<code>type = "none"</code> to get model without constant term.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">fit_har</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vhar_lm.html">vhar_lm</a></span><span class="op">(</span><span class="va">etf_train</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; vhar_lm(y = etf_train)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; VHAR Estimation====================================================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; LSE for day:</span></span>
<span><span class="co">#&gt;           GVZCLS_day  OVXCLS_day  EVZCLS_day  VXFXICLS_day</span></span>
<span><span class="co">#&gt; GVZCLS       0.87561      0.0447      0.1623      -0.03772</span></span>
<span><span class="co">#&gt; OVXCLS       0.04147      0.9942     -0.0605      -0.09361</span></span>
<span><span class="co">#&gt; EVZCLS       0.00305      0.0281      0.9206      -0.00748</span></span>
<span><span class="co">#&gt; VXFXICLS     0.01021      0.0569      0.0440       0.91713</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; LSE for week:</span></span>
<span><span class="co">#&gt;           GVZCLS_week  OVXCLS_week  EVZCLS_week  VXFXICLS_week</span></span>
<span><span class="co">#&gt; GVZCLS        0.01622      -0.0554      -0.1608         0.0637</span></span>
<span><span class="co">#&gt; OVXCLS       -0.07093      -0.0373       0.2000         0.1034</span></span>
<span><span class="co">#&gt; EVZCLS       -0.00334      -0.0414      -0.0101         0.0239</span></span>
<span><span class="co">#&gt; VXFXICLS     -0.03756      -0.0787      -0.0135         0.0480</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; LSE for month:</span></span>
<span><span class="co">#&gt;           GVZCLS_month  OVXCLS_month  EVZCLS_month  VXFXICLS_month</span></span>
<span><span class="co">#&gt; GVZCLS        0.084981       0.00359        0.0228         -0.0299</span></span>
<span><span class="co">#&gt; OVXCLS        0.045986       0.03825       -0.1564         -0.0157</span></span>
<span><span class="co">#&gt; EVZCLS       -0.000597       0.02030        0.0501         -0.0138</span></span>
<span><span class="co">#&gt; VXFXICLS      0.041648       0.01263        0.0639         -0.0371</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; LSE for constant:</span></span>
<span><span class="co">#&gt;   GVZCLS    OVXCLS    EVZCLS  VXFXICLS  </span></span>
<span><span class="co">#&gt;    0.491     0.135     0.105     0.926  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --------------------------------------------------</span></span>
<span><span class="co">#&gt; *_day, *_week, *_month of the Coefficient matrix: daily, weekly, and monthly term in the VHAR model</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># class----------------</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">fit_har</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "vharlse"  "olsmod"   "bvharmod"</span></span>
<span><span class="co"># inheritance----------</span></span>
<span><span class="fu"><a href="../reference/var_lm.html">is.varlse</a></span><span class="op">(</span><span class="va">fit_har</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span><span class="fu"><a href="../reference/vhar_lm.html">is.vharlse</a></span><span class="op">(</span><span class="va">fit_har</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="co"># complements----------</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">fit_har</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "coefficients"  "fitted.values" "residuals"     "covmat"       </span></span>
<span><span class="co">#&gt;  [5] "df"            "m"             "obs"           "y0"           </span></span>
<span><span class="co">#&gt;  [9] "p"             "week"          "month"         "totobs"       </span></span>
<span><span class="co">#&gt; [13] "process"       "type"          "HARtrans"      "design"       </span></span>
<span><span class="co">#&gt; [17] "y"             "method"        "call"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="bvar">BVAR<a class="anchor" aria-label="anchor" href="#bvar"></a>
</h3>
<p><code>bvhar</code> package provides two prior framework - Minnesota
prior and flat prior.</p>
<div class="section level4">
<h4 id="minnesota-prior">Minnesota prior<a class="anchor" aria-label="anchor" href="#minnesota-prior"></a>
</h4>
<ul>
<li>Litterman (1986) and Bańbura et al. (2010)</li>
<li>All the equations are centered around the random walk with
drift.</li>
<li>
<em>Prior mean</em>: Recent lags provide more reliable information
than the more distant ones.</li>
<li>
<em>Prior variance</em>: Own lags explain more of the variation of a
given variable than the lags of other variables in the equation.</li>
</ul>
<p>First specify the prior using
<code>set_bvar(sigma, lambda, delta, eps = 1e-04)</code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bvar_lag</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">sig</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">etf_train</span>, <span class="fl">2</span>, <span class="va">sd</span><span class="op">)</span> <span class="co"># sigma vector</span></span>
<span><span class="va">lam</span> <span class="op">&lt;-</span> <span class="fl">.2</span> <span class="co"># lambda</span></span>
<span><span class="va">delta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">m</span><span class="op">)</span> <span class="co"># delta vector (0 vector since RV stationary)</span></span>
<span><span class="va">eps</span> <span class="op">&lt;-</span> <span class="fl">1e-04</span> <span class="co"># very small number</span></span>
<span><span class="op">(</span><span class="va">bvar_spec</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_bvar.html">set_bvar</a></span><span class="op">(</span><span class="va">sig</span>, <span class="va">lam</span>, <span class="va">delta</span>, <span class="va">eps</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Model Specification for BVAR</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameters: Coefficent matrice and Covariance matrix</span></span>
<span><span class="co">#&gt; Prior: Minnesota</span></span>
<span><span class="co">#&gt; ========================================================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Setting for 'sigma':</span></span>
<span><span class="co">#&gt;   GVZCLS    OVXCLS    EVZCLS  VXFXICLS  </span></span>
<span><span class="co">#&gt;     3.77     10.63      2.27      3.81  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Setting for 'lambda':</span></span>
<span><span class="co">#&gt; [1]  0.2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Setting for 'delta':</span></span>
<span><span class="co">#&gt; [1]  0  0  0  0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Setting for 'eps':</span></span>
<span><span class="co">#&gt; [1]  1e-04</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Setting for 'hierarchical':</span></span>
<span><span class="co">#&gt; [1]  FALSE</span></span></code></pre></div>
<p>In turn,
<code>bvar_minnesota(y, p, bayes_spec, include_mean = TRUE)</code> fits
BVAR(p).</p>
<ul>
<li>
<code>y</code>: Multivariate time series data. It should be data
frame or matrix, which means that every column is numeric. Each column
indicates variable, i.e. it sould be wide format.</li>
<li>
<code>p</code>: Order of BVAR</li>
<li>
<code>bayes_spec</code>: Output of <code><a href="../reference/set_bvar.html">set_bvar()</a></code>
</li>
<li>
<code>include_mean = TRUE</code>: By default, you include the
constant term in the model.</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">fit_bvar</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bvar_minnesota.html">bvar_minnesota</a></span><span class="op">(</span><span class="va">etf_train</span>, <span class="va">bvar_lag</span>, num_iter <span class="op">=</span> <span class="fl">10</span>, bayes_spec <span class="op">=</span> <span class="va">bvar_spec</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; bvar_minnesota(y = etf_train, p = bvar_lag, num_iter = 10, bayes_spec = bvar_spec)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; BVAR(5) with Minnesota Prior</span></span>
<span><span class="co">#&gt; ====================================================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; A ~ Matrix Normal (Mean, Precision, Scale = Sigma)</span></span>
<span><span class="co">#&gt; ====================================================</span></span>
<span><span class="co">#&gt; Matrix Normal Mean for A1 part:</span></span>
<span><span class="co">#&gt;           GVZCLS_1  OVXCLS_1  EVZCLS_1  VXFXICLS_1</span></span>
<span><span class="co">#&gt; GVZCLS      0.7771   0.00915    0.0628      0.0193</span></span>
<span><span class="co">#&gt; OVXCLS      0.0445   0.70884    0.1111      0.0167</span></span>
<span><span class="co">#&gt; EVZCLS      0.0104   0.01068    0.7036      0.0266</span></span>
<span><span class="co">#&gt; VXFXICLS    0.0214   0.00673    0.1044      0.7674</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix Normal Mean for A2 part:</span></span>
<span><span class="co">#&gt;            GVZCLS_2   OVXCLS_2  EVZCLS_2  VXFXICLS_2</span></span>
<span><span class="co">#&gt; GVZCLS     0.082726  -0.006736  -0.01387     -0.0020</span></span>
<span><span class="co">#&gt; OVXCLS     0.000568   0.140781   0.02419     -0.0436</span></span>
<span><span class="co">#&gt; EVZCLS    -0.004778   0.000769   0.11756     -0.0114</span></span>
<span><span class="co">#&gt; VXFXICLS   0.013424  -0.003779   0.00369      0.1063</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix Normal Mean for A3 part:</span></span>
<span><span class="co">#&gt;           GVZCLS_3   OVXCLS_3  EVZCLS_3  VXFXICLS_3</span></span>
<span><span class="co">#&gt; GVZCLS     0.03574  -0.003825  -0.01504    -0.00581</span></span>
<span><span class="co">#&gt; OVXCLS    -0.01733   0.054037   0.00196    -0.01874</span></span>
<span><span class="co">#&gt; EVZCLS    -0.00391   0.000223   0.05065    -0.00168</span></span>
<span><span class="co">#&gt; VXFXICLS  -0.00891  -0.006167  -0.00435     0.02176</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix Normal Mean for A4 part:</span></span>
<span><span class="co">#&gt;           GVZCLS_4   OVXCLS_4   EVZCLS_4  VXFXICLS_4</span></span>
<span><span class="co">#&gt; GVZCLS     0.02474  -0.001932  -0.011546     0.00263</span></span>
<span><span class="co">#&gt; OVXCLS    -0.00987   0.030763   0.003771     0.00845</span></span>
<span><span class="co">#&gt; EVZCLS    -0.00318  -0.000206   0.027289     0.00161</span></span>
<span><span class="co">#&gt; VXFXICLS  -0.00898  -0.004378   0.000232     0.00582</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix Normal Mean for A5 part:</span></span>
<span><span class="co">#&gt;           GVZCLS_5   OVXCLS_5  EVZCLS_5  VXFXICLS_5</span></span>
<span><span class="co">#&gt; GVZCLS     0.01986  -1.47e-03  -0.00970     0.00127</span></span>
<span><span class="co">#&gt; OVXCLS    -0.00357   2.10e-02   0.00339     0.01017</span></span>
<span><span class="co">#&gt; EVZCLS    -0.00284   1.59e-05   0.01729     0.00159</span></span>
<span><span class="co">#&gt; VXFXICLS  -0.00431  -1.70e-03   0.00263     0.01207</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix Normal Mean for constant part:</span></span>
<span><span class="co">#&gt;   GVZCLS    OVXCLS    EVZCLS  VXFXICLS  </span></span>
<span><span class="co">#&gt;   0.7271    0.3713    0.0971    1.2139  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; dim(Matrix Normal precision matrix):</span></span>
<span><span class="co">#&gt; [1]  21  21</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sigma ~ Inverse-Wishart</span></span>
<span><span class="co">#&gt; ====================================================</span></span>
<span><span class="co">#&gt; IW scale matrix:</span></span>
<span><span class="co">#&gt;           GVZCLS  OVXCLS  EVZCLS  VXFXICLS</span></span>
<span><span class="co">#&gt; GVZCLS      1285     375     115       287</span></span>
<span><span class="co">#&gt; OVXCLS       375    3638     131       397</span></span>
<span><span class="co">#&gt; EVZCLS       115     131     220       126</span></span>
<span><span class="co">#&gt; VXFXICLS     287     397     126      1186</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; IW degrees of freedom:</span></span>
<span><span class="co">#&gt; [1] 887</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --------------------------------------------------</span></span>
<span><span class="co">#&gt; *_j of the Coefficient matrix: corresponding to the j-th BVAR lag</span></span></code></pre></div>
<p>It is <code>bvarmn</code> class. For Bayes computation, it also has
other class such as <code>normaliw</code> and <code>bvharmod</code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># class---------------</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">fit_bvar</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "bvarmn"   "bvharmod" "normaliw"</span></span>
<span><span class="co"># inheritance---------</span></span>
<span><span class="fu"><a href="../reference/bvar_minnesota.html">is.bvarmn</a></span><span class="op">(</span><span class="va">fit_bvar</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="co"># names---------------</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">fit_bvar</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "coefficients"    "fitted.values"   "residuals"       "mn_prec"        </span></span>
<span><span class="co">#&gt;  [5] "covmat"          "iw_shape"        "df"              "m"              </span></span>
<span><span class="co">#&gt;  [9] "obs"             "prior_mean"      "prior_precision" "prior_scale"    </span></span>
<span><span class="co">#&gt; [13] "prior_shape"     "y0"              "design"          "p"              </span></span>
<span><span class="co">#&gt; [17] "totobs"          "type"            "y"               "chain"          </span></span>
<span><span class="co">#&gt; [21] "iter"            "burn"            "thin"            "call"           </span></span>
<span><span class="co">#&gt; [25] "process"         "spec"</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="flat-prior">Flat prior<a class="anchor" aria-label="anchor" href="#flat-prior"></a>
</h4>
<p>Ghosh et al. (2018) provides flat prior for covariance matrix,
i.e. non-informative. Use <code>set_bvar_flat(U)</code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">flat_spec</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_bvar.html">set_bvar_flat</a></span><span class="op">(</span>U <span class="op">=</span> <span class="fl">5000</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">m</span> <span class="op">*</span> <span class="va">bvar_lag</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co"># c * I</span></span>
<span><span class="co">#&gt; Model Specification for BVAR</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameters: Coefficent matrice and Covariance matrix</span></span>
<span><span class="co">#&gt; Prior: Flat</span></span>
<span><span class="co">#&gt; ========================================================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Setting for 'U':</span></span>
<span><span class="co">#&gt; # A matrix:  21 x 21 </span></span>
<span><span class="co">#&gt;        [,1]  [,2]  [,3]  [,4]  [,5]</span></span>
<span><span class="co">#&gt;  [1,]  5000     0     0     0     0</span></span>
<span><span class="co">#&gt;  [2,]     0  5000     0     0     0</span></span>
<span><span class="co">#&gt;  [3,]     0     0  5000     0     0</span></span>
<span><span class="co">#&gt;  [4,]     0     0     0  5000     0</span></span>
<span><span class="co">#&gt;  [5,]     0     0     0     0  5000</span></span>
<span><span class="co">#&gt;  [6,]     0     0     0     0     0</span></span>
<span><span class="co">#&gt;  [7,]     0     0     0     0     0</span></span>
<span><span class="co">#&gt;  [8,]     0     0     0     0     0</span></span>
<span><span class="co">#&gt;  [9,]     0     0     0     0     0</span></span>
<span><span class="co">#&gt; [10,]     0     0     0     0     0</span></span>
<span><span class="co">#&gt; # ... with 11 more rows</span></span></code></pre></div>
<p>Then
<code>bvar_flat(y, p, bayes_spec, include_mean = TRUE)</code>:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">fit_ghosh</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bvar_flat.html">bvar_flat</a></span><span class="op">(</span><span class="va">etf_train</span>, <span class="va">bvar_lag</span>, num_iter <span class="op">=</span> <span class="fl">10</span>, bayes_spec <span class="op">=</span> <span class="va">flat_spec</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; bvar_flat(y = etf_train, p = bvar_lag, num_iter = 10, bayes_spec = flat_spec)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; BVAR(5) with Flat Prior</span></span>
<span><span class="co">#&gt; ====================================================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; A ~ Matrix Normal (Mean, U^{-1}, Scale 2 = Sigma)</span></span>
<span><span class="co">#&gt; ====================================================</span></span>
<span><span class="co">#&gt; Matrix Normal Mean for A1 part:</span></span>
<span><span class="co">#&gt;           GVZCLS_1  OVXCLS_1  EVZCLS_1  VXFXICLS_1</span></span>
<span><span class="co">#&gt; GVZCLS      0.3128    0.0460    0.0205      0.0457</span></span>
<span><span class="co">#&gt; OVXCLS      0.0440    0.4128    0.0186      0.0314</span></span>
<span><span class="co">#&gt; EVZCLS      0.0174    0.0230    0.1334      0.0410</span></span>
<span><span class="co">#&gt; VXFXICLS    0.0477    0.0464    0.0481      0.3197</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix Normal Mean for A2 part:</span></span>
<span><span class="co">#&gt;           GVZCLS_2  OVXCLS_2  EVZCLS_2  VXFXICLS_2</span></span>
<span><span class="co">#&gt; GVZCLS     0.19811   0.00287   0.00771      0.0194</span></span>
<span><span class="co">#&gt; OVXCLS     0.01595   0.23709   0.00978     -0.0111</span></span>
<span><span class="co">#&gt; EVZCLS     0.00425   0.01205   0.11715      0.0201</span></span>
<span><span class="co">#&gt; VXFXICLS   0.02725   0.01516   0.03513      0.2162</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix Normal Mean for A3 part:</span></span>
<span><span class="co">#&gt;           GVZCLS_3  OVXCLS_3  EVZCLS_3  VXFXICLS_3</span></span>
<span><span class="co">#&gt; GVZCLS     0.13884   -0.0153  -0.00102     0.00591</span></span>
<span><span class="co">#&gt; OVXCLS    -0.00741    0.1304   0.00361    -0.02452</span></span>
<span><span class="co">#&gt; EVZCLS    -0.00353    0.0079   0.10724     0.01150</span></span>
<span><span class="co">#&gt; VXFXICLS   0.00797   -0.0146   0.02633     0.14628</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix Normal Mean for A4 part:</span></span>
<span><span class="co">#&gt;           GVZCLS_4  OVXCLS_4  EVZCLS_4  VXFXICLS_4</span></span>
<span><span class="co">#&gt; GVZCLS     0.11392  -0.01775  -0.00653     0.00884</span></span>
<span><span class="co">#&gt; OVXCLS    -0.01626   0.09421   0.00195    -0.00572</span></span>
<span><span class="co">#&gt; EVZCLS    -0.00847   0.00565   0.10046     0.01098</span></span>
<span><span class="co">#&gt; VXFXICLS  -0.00356  -0.03067   0.02292     0.10552</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix Normal Mean for A5 part:</span></span>
<span><span class="co">#&gt;           GVZCLS_5  OVXCLS_5  EVZCLS_5  VXFXICLS_5</span></span>
<span><span class="co">#&gt; GVZCLS     0.11282   -0.0208  -0.01028     0.01136</span></span>
<span><span class="co">#&gt; OVXCLS    -0.01507    0.1004   0.00155     0.00973</span></span>
<span><span class="co">#&gt; EVZCLS    -0.01252    0.0104   0.09667     0.01361</span></span>
<span><span class="co">#&gt; VXFXICLS  -0.00492   -0.0215   0.02342     0.10353</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix Normal Mean for constant part:</span></span>
<span><span class="co">#&gt;   GVZCLS    OVXCLS    EVZCLS  VXFXICLS  </span></span>
<span><span class="co">#&gt; 5.49e-03  7.82e-04  8.83e-05  9.82e-03  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; dim(Matrix Normal precision matrix):</span></span>
<span><span class="co">#&gt; [1]  21  21</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sigma ~ Inverse-Wishart</span></span>
<span><span class="co">#&gt; ====================================================</span></span>
<span><span class="co">#&gt; IW scale matrix:</span></span>
<span><span class="co">#&gt;           GVZCLS  OVXCLS  EVZCLS  VXFXICLS</span></span>
<span><span class="co">#&gt; GVZCLS      2483     595     209       535</span></span>
<span><span class="co">#&gt; OVXCLS       595    3580     216       578</span></span>
<span><span class="co">#&gt; EVZCLS       209     216     771       354</span></span>
<span><span class="co">#&gt; VXFXICLS     535     578     354      2472</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --------------------------------------------------</span></span>
<span><span class="co">#&gt; *_j of the Coefficient matrix: corresponding to the j-th BVAR lag</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># class---------------</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">fit_ghosh</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "bvarflat" "normaliw" "bvharmod"</span></span>
<span><span class="co"># inheritance---------</span></span>
<span><span class="fu"><a href="../reference/bvar_flat.html">is.bvarflat</a></span><span class="op">(</span><span class="va">fit_ghosh</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="co"># names---------------</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">fit_ghosh</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "coefficients"    "fitted.values"   "residuals"       "mn_prec"        </span></span>
<span><span class="co">#&gt;  [5] "covmat"          "iw_shape"        "df"              "m"              </span></span>
<span><span class="co">#&gt;  [9] "obs"             "prior_mean"      "prior_precision" "y0"             </span></span>
<span><span class="co">#&gt; [13] "design"          "y"               "p"               "type"           </span></span>
<span><span class="co">#&gt; [17] "chain"           "iter"            "burn"            "thin"           </span></span>
<span><span class="co">#&gt; [21] "call"            "process"         "spec"</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="bvhar">BVHAR<a class="anchor" aria-label="anchor" href="#bvhar"></a>
</h3>
<p>Consider the VAR(22) form of VHAR.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>𝐘</mi><mi>t</mi></msub><mo>=</mo><mi>𝐜</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>Φ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>d</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo>+</mo><mfrac><mn>1</mn><mn>5</mn></mfrac><msup><mi>Φ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo>+</mo><mfrac><mn>1</mn><mn>22</mn></mfrac><msup><mi>Φ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>𝐘</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mn>1</mn><mn>5</mn></mfrac><msup><mi>Φ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo>+</mo><mfrac><mn>1</mn><mn>22</mn></mfrac><msup><mi>Φ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>𝐘</mi><mrow><mi>t</mi><mo>−</mo><mn>2</mn></mrow></msub><mo>+</mo><mi>⋯</mi><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mn>1</mn><mn>5</mn></mfrac><msup><mi>Φ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo>+</mo><mfrac><mn>1</mn><mn>22</mn></mfrac><msup><mi>Φ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>𝐘</mi><mrow><mi>t</mi><mo>−</mo><mn>5</mn></mrow></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>+</mo><mfrac><mn>1</mn><mn>22</mn></mfrac><msup><mi>Φ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><msub><mi>𝐘</mi><mrow><mi>t</mi><mo>−</mo><mn>6</mn></mrow></msub><mo>+</mo><mi>⋯</mi><mo>+</mo><mfrac><mn>1</mn><mn>22</mn></mfrac><msup><mi>Φ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><msub><mi>𝐘</mi><mrow><mi>t</mi><mo>−</mo><mn>22</mn></mrow></msub></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
  \mathbf{Y}_t = \mathbf{c}&amp; + \left( \Phi^{(d)} + \frac{1}{5} \Phi^{(w)} + \frac{1}{22} \Phi^{(m)} \right) \mathbf{Y}_{t - 1} \\
  &amp; + \left( \frac{1}{5} \Phi^{(w)} + \frac{1}{22} \Phi^{(m)} \right) \mathbf{Y}_{t - 2} + \cdots \left( \frac{1}{5} \Phi^{(w)} + \frac{1}{22} \Phi^{(m)} \right) \mathbf{Y}_{t - 5} \\
  &amp; + \frac{1}{22} \Phi^{(m)} \mathbf{Y}_{t - 6} + \cdots + \frac{1}{22} \Phi^{(m)} \mathbf{Y}_{t - 22}
\end{aligned}
</annotation></semantics></math></p>
<p>What does Minnesota prior mean in VHAR model?</p>
<ul>
<li>All the equations are centered around
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>𝐘</mi><mi>t</mi></msub><mo>+</mo><mi>𝐜</mi><mo>+</mo><msup><mi>Φ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>d</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><msub><mi>𝐘</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>𝛜</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\mathbf{Y}_t + \mathbf{c}+ \Phi^{(d)} \mathbf{Y}_{t - 1} + \boldsymbol\epsilon_t</annotation></semantics></math>
</li>
<li>RW form: shrink diagonal elements of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>Φ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>d</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><annotation encoding="application/x-tex">\Phi^{(d)}</annotation></semantics></math>
toward one
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>Φ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><annotation encoding="application/x-tex">\Phi^{(w)}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>Φ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><annotation encoding="application/x-tex">\Phi^{(m)}</annotation></semantics></math>
to zero</li>
</ul>
</li>
<li>WN form:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>δ</mi><mi>i</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\delta_i = 0</annotation></semantics></math>
</li>
</ul>
<p>For more simplicity, write coefficient matrices by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Φ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo>,</mo><msup><mi>Φ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo>,</mo><msup><mi>Φ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>3</mn><mo stretchy="true" form="postfix">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">\Phi^{(1)}, \Phi^{(2)}, \Phi^{(3)}</annotation></semantics></math>.
If we apply the prior in the same way, Minnesota moment becomes</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>Φ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>l</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><msub><mi>δ</mi><mi>i</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mi>j</mi><mo>=</mo><mi>i</mi><mo>,</mo><mspace width="0.278em"></mspace><mi>l</mi><mo>=</mo><mn>1</mn></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mn>0</mn></mtd><mtd columnalign="left" style="text-align: left"><mi>o</mi><mi>/</mi><mi>w</mi></mtd></mtr></mtable></mrow><mspace width="1.0em"></mspace><mrow><mi mathvariant="normal">V</mi><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi></mrow><mrow><mo stretchy="true" form="prefix">[</mo><msub><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>Φ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>l</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><mfrac><msup><mi>λ</mi><mn>2</mn></msup><msup><mi>l</mi><mn>2</mn></msup></mfrac></mtd><mtd columnalign="left" style="text-align: left"><mi>j</mi><mo>=</mo><mi>i</mi></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mi>ν</mi><mfrac><msup><mi>λ</mi><mn>2</mn></msup><msup><mi>l</mi><mn>2</mn></msup></mfrac><mfrac><msubsup><mi>σ</mi><mi>i</mi><mn>2</mn></msubsup><msubsup><mi>σ</mi><mi>j</mi><mn>2</mn></msubsup></mfrac></mtd><mtd columnalign="left" style="text-align: left"><mi>o</mi><mi>/</mi><mi>w</mi></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
E \left[ (\Phi^{(l)})_{ij} \right] = \begin{cases}
  \delta_i &amp; j = i, \; l = 1 \\
  0 &amp; o/w
\end{cases} \quad \mathrm{Var}\left[ (\Phi^{(l)})_{ij} \right] = \begin{cases}
  \frac{\lambda^2}{l^2} &amp; j = i \\
  \nu \frac{\lambda^2}{l^2} \frac{\sigma_i^2}{\sigma_j^2} &amp; o/w
\end{cases}
</annotation></semantics></math></p>
<p>We call this VAR-type Minnesota prior or BVHAR-S.</p>
<div class="section level4">
<h4 id="bvhar-s">BVHAR-S<a class="anchor" aria-label="anchor" href="#bvhar-s"></a>
</h4>
<p><code>set_bvhar(sigma, lambda, delta, eps = 1e-04)</code> specifies
VAR-type Minnesota prior.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">bvhar_spec_v1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_bvar.html">set_bvhar</a></span><span class="op">(</span><span class="va">sig</span>, <span class="va">lam</span>, <span class="va">delta</span>, <span class="va">eps</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Model Specification for BVHAR</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameters: Coefficent matrice and Covariance matrix</span></span>
<span><span class="co">#&gt; Prior: MN_VAR</span></span>
<span><span class="co">#&gt; ========================================================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Setting for 'sigma':</span></span>
<span><span class="co">#&gt;   GVZCLS    OVXCLS    EVZCLS  VXFXICLS  </span></span>
<span><span class="co">#&gt;     3.77     10.63      2.27      3.81  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Setting for 'lambda':</span></span>
<span><span class="co">#&gt; [1]  0.2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Setting for 'delta':</span></span>
<span><span class="co">#&gt; [1]  0  0  0  0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Setting for 'eps':</span></span>
<span><span class="co">#&gt; [1]  1e-04</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Setting for 'hierarchical':</span></span>
<span><span class="co">#&gt; [1]  FALSE</span></span></code></pre></div>
<p><code>bvhar_minnesota(y, har = c(5, 22), bayes_spec, include_mean = TRUE)</code>
can fit BVHAR with this prior. This is the default prior setting.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">fit_bvhar_v1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bvhar_minnesota.html">bvhar_minnesota</a></span><span class="op">(</span><span class="va">etf_train</span>, num_iter <span class="op">=</span> <span class="fl">10</span>, bayes_spec <span class="op">=</span> <span class="va">bvhar_spec_v1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; bvhar_minnesota(y = etf_train, num_iter = 10, bayes_spec = bvhar_spec_v1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; BVHAR with Minnesota Prior</span></span>
<span><span class="co">#&gt; ====================================================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Phi ~ Matrix Normal (Mean, Scale 1, Scale 2 = Sigma)</span></span>
<span><span class="co">#&gt; ====================================================</span></span>
<span><span class="co">#&gt; Matrix Normal Mean for day:</span></span>
<span><span class="co">#&gt;           GVZCLS_day  OVXCLS_day  EVZCLS_day  VXFXICLS_day</span></span>
<span><span class="co">#&gt; GVZCLS        0.7808     0.00502      0.0595        0.0181</span></span>
<span><span class="co">#&gt; OVXCLS        0.0419     0.75268      0.1293       -0.0129</span></span>
<span><span class="co">#&gt; EVZCLS        0.0109     0.00957      0.7248        0.0213</span></span>
<span><span class="co">#&gt; VXFXICLS      0.0252     0.00347      0.1003        0.8042</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix Normal Mean for week:</span></span>
<span><span class="co">#&gt;           GVZCLS_week  OVXCLS_week  EVZCLS_week  VXFXICLS_week</span></span>
<span><span class="co">#&gt; GVZCLS         0.1160    -0.007669     -0.03216       -0.00181</span></span>
<span><span class="co">#&gt; OVXCLS        -0.0211     0.152822      0.02794       -0.00136</span></span>
<span><span class="co">#&gt; EVZCLS        -0.0103    -0.000372      0.13214       -0.00158</span></span>
<span><span class="co">#&gt; VXFXICLS      -0.0177    -0.010393      0.00229        0.10274</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix Normal Mean for month:</span></span>
<span><span class="co">#&gt;           GVZCLS_month  OVXCLS_month  EVZCLS_month  VXFXICLS_month</span></span>
<span><span class="co">#&gt; GVZCLS         0.05269      -0.00345       -0.0110        -0.00302</span></span>
<span><span class="co">#&gt; OVXCLS         0.00556       0.05169       -0.0225        -0.01051</span></span>
<span><span class="co">#&gt; EVZCLS        -0.00441       0.00410        0.0502        -0.00138</span></span>
<span><span class="co">#&gt; VXFXICLS       0.00733      -0.00321        0.0109         0.00573</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix Normal Mean for constant part:</span></span>
<span><span class="co">#&gt;   GVZCLS    OVXCLS    EVZCLS  VXFXICLS  </span></span>
<span><span class="co">#&gt;   0.6107    0.1410    0.0741    1.1544  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; dim(Matrix Normal precision matrix):</span></span>
<span><span class="co">#&gt; [1]  13  13</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sigma ~ Inverse-Wishart</span></span>
<span><span class="co">#&gt; ====================================================</span></span>
<span><span class="co">#&gt; IW scale matrix:</span></span>
<span><span class="co">#&gt;           GVZCLS  OVXCLS  EVZCLS  VXFXICLS</span></span>
<span><span class="co">#&gt; GVZCLS      1268     366     114       286</span></span>
<span><span class="co">#&gt; OVXCLS       366    3742     131       378</span></span>
<span><span class="co">#&gt; EVZCLS       114     131     219       121</span></span>
<span><span class="co">#&gt; VXFXICLS     286     378     121      1189</span></span></code></pre></div>
<p>This model is <code>bvharmn</code> class.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># class---------------</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">fit_bvhar_v1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "bvharmn"  "bvharmod" "normaliw"</span></span>
<span><span class="co"># inheritance---------</span></span>
<span><span class="fu"><a href="../reference/bvhar_minnesota.html">is.bvharmn</a></span><span class="op">(</span><span class="va">fit_bvhar_v1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="co"># names---------------</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">fit_bvhar_v1</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "coefficients"    "fitted.values"   "residuals"       "mn_prec"        </span></span>
<span><span class="co">#&gt;  [5] "covmat"          "iw_shape"        "df"              "m"              </span></span>
<span><span class="co">#&gt;  [9] "obs"             "prior_mean"      "prior_precision" "prior_scale"    </span></span>
<span><span class="co">#&gt; [13] "prior_shape"     "y0"              "design"          "p"              </span></span>
<span><span class="co">#&gt; [17] "week"            "month"           "totobs"          "type"           </span></span>
<span><span class="co">#&gt; [21] "HARtrans"        "y"               "chain"           "iter"           </span></span>
<span><span class="co">#&gt; [25] "burn"            "thin"            "call"            "process"        </span></span>
<span><span class="co">#&gt; [29] "spec"</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="bvhar-l">BVHAR-L<a class="anchor" aria-label="anchor" href="#bvhar-l"></a>
</h4>
<p>Set
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>δ</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\delta_i</annotation></semantics></math>
for weekly and monthly coefficient matrices in above Minnesota
moments:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><msub><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>Φ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>l</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><msub><mi>d</mi><mi>i</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mi>j</mi><mo>=</mo><mi>i</mi><mo>,</mo><mspace width="0.278em"></mspace><mi>l</mi><mo>=</mo><mn>1</mn></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><msub><mi>w</mi><mi>i</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mi>j</mi><mo>=</mo><mi>i</mi><mo>,</mo><mspace width="0.278em"></mspace><mi>l</mi><mo>=</mo><mn>2</mn></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><msub><mi>m</mi><mi>i</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mi>j</mi><mo>=</mo><mi>i</mi><mo>,</mo><mspace width="0.278em"></mspace><mi>l</mi><mo>=</mo><mn>3</mn></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
E \left[ (\Phi^{(l)})_{ij} \right] = \begin{cases}
  d_i &amp; j = i, \; l = 1 \\
  w_i &amp; j = i, \; l = 2 \\
  m_i &amp; j = i, \; l = 3
\end{cases}
</annotation></semantics></math></p>
<p>i.e. instead of one <code>delta</code> vector, set three vector</p>
<ul>
<li><code>daily</code></li>
<li><code>weekly</code></li>
<li><code>monthly</code></li>
</ul>
<p>This is called VHAR-type Minnesota prior or BVHAR-L.</p>
<p><code>set_weight_bvhar(sigma, lambda, eps, daily, weekly, monthly)</code>
defines BVHAR-L.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">daily</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">.1</span>, <span class="va">m</span><span class="op">)</span></span>
<span><span class="va">weekly</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">.1</span>, <span class="va">m</span><span class="op">)</span></span>
<span><span class="va">monthly</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">.1</span>, <span class="va">m</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">bvhar_spec_v2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_bvar.html">set_weight_bvhar</a></span><span class="op">(</span><span class="va">sig</span>, <span class="va">lam</span>, <span class="va">eps</span>, <span class="va">daily</span>, <span class="va">weekly</span>, <span class="va">monthly</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Model Specification for BVHAR</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameters: Coefficent matrice and Covariance matrix</span></span>
<span><span class="co">#&gt; Prior: MN_VHAR</span></span>
<span><span class="co">#&gt; ========================================================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Setting for 'sigma':</span></span>
<span><span class="co">#&gt;   GVZCLS    OVXCLS    EVZCLS  VXFXICLS  </span></span>
<span><span class="co">#&gt;     3.77     10.63      2.27      3.81  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Setting for 'lambda':</span></span>
<span><span class="co">#&gt; [1]  0.2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Setting for 'eps':</span></span>
<span><span class="co">#&gt; [1]  1e-04</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Setting for 'daily':</span></span>
<span><span class="co">#&gt; [1]  0.1  0.1  0.1  0.1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Setting for 'weekly':</span></span>
<span><span class="co">#&gt; [1]  0.1  0.1  0.1  0.1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Setting for 'monthly':</span></span>
<span><span class="co">#&gt; [1]  0.1  0.1  0.1  0.1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Setting for 'hierarchical':</span></span>
<span><span class="co">#&gt; [1]  FALSE</span></span></code></pre></div>
<p><code>bayes_spec</code> option of <code><a href="../reference/bvhar_minnesota.html">bvhar_minnesota()</a></code> gets
this value, so you can use this prior intuitively.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_bvhar_v2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bvhar_minnesota.html">bvhar_minnesota</a></span><span class="op">(</span></span>
<span>  <span class="va">etf_train</span>,</span>
<span>  num_iter <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  bayes_spec <span class="op">=</span> <span class="va">bvhar_spec_v2</span></span>
<span><span class="op">)</span></span>
<span><span class="va">fit_bvhar_v2</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; bvhar_minnesota(y = etf_train, num_iter = 10, bayes_spec = bvhar_spec_v2)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; BVHAR with Minnesota Prior</span></span>
<span><span class="co">#&gt; ====================================================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Phi ~ Matrix Normal (Mean, Scale 1, Scale 2 = Sigma)</span></span>
<span><span class="co">#&gt; ====================================================</span></span>
<span><span class="co">#&gt; Matrix Normal Mean for day:</span></span>
<span><span class="co">#&gt;           GVZCLS_day  OVXCLS_day  EVZCLS_day  VXFXICLS_day</span></span>
<span><span class="co">#&gt; GVZCLS        0.7670     0.00504      0.0644       0.01884</span></span>
<span><span class="co">#&gt; OVXCLS        0.0497     0.73098      0.0999      -0.00317</span></span>
<span><span class="co">#&gt; EVZCLS        0.0122     0.00907      0.7094       0.02036</span></span>
<span><span class="co">#&gt; VXFXICLS      0.0259     0.00429      0.0976       0.79368</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix Normal Mean for week:</span></span>
<span><span class="co">#&gt;           GVZCLS_week  OVXCLS_week  EVZCLS_week  VXFXICLS_week</span></span>
<span><span class="co">#&gt; GVZCLS         0.1259    -0.008055     -0.03361       -0.00353</span></span>
<span><span class="co">#&gt; OVXCLS        -0.0222     0.168704      0.01523       -0.00218</span></span>
<span><span class="co">#&gt; EVZCLS        -0.0108    -0.000896      0.14770       -0.00294</span></span>
<span><span class="co">#&gt; VXFXICLS      -0.0199    -0.010546     -0.00238        0.11358</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix Normal Mean for month:</span></span>
<span><span class="co">#&gt;           GVZCLS_month  OVXCLS_month  EVZCLS_month  VXFXICLS_month</span></span>
<span><span class="co">#&gt; GVZCLS         0.06476      -0.00349      -0.01286        -0.00584</span></span>
<span><span class="co">#&gt; OVXCLS         0.00142       0.06915      -0.03315        -0.01117</span></span>
<span><span class="co">#&gt; EVZCLS        -0.00492       0.00329       0.06611        -0.00337</span></span>
<span><span class="co">#&gt; VXFXICLS       0.00474      -0.00312       0.00592         0.01821</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix Normal Mean for constant part:</span></span>
<span><span class="co">#&gt;   GVZCLS    OVXCLS    EVZCLS  VXFXICLS  </span></span>
<span><span class="co">#&gt;   0.5517    0.0335    0.0834    1.0025  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; dim(Matrix Normal precision matrix):</span></span>
<span><span class="co">#&gt; [1]  13  13</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sigma ~ Inverse-Wishart</span></span>
<span><span class="co">#&gt; ====================================================</span></span>
<span><span class="co">#&gt; IW scale matrix:</span></span>
<span><span class="co">#&gt;           GVZCLS  OVXCLS  EVZCLS  VXFXICLS</span></span>
<span><span class="co">#&gt; GVZCLS      1194     372     115       286</span></span>
<span><span class="co">#&gt; OVXCLS       372    3124     125       387</span></span>
<span><span class="co">#&gt; EVZCLS       115     125     193       119</span></span>
<span><span class="co">#&gt; VXFXICLS     286     387     119      1123</span></span></code></pre></div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Young Geun Kim.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
