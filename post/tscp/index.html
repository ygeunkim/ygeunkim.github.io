<!DOCTYPE html>
<!-- This site was created with Wowchemy. https://www.wowchemy.com -->
<!-- Last Published: November 11, 2023 --><html lang="en-us" >


<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  
  
    <meta name="generator" content="Wowchemy 5.7.0 for Hugo" />
  

  
  












  
  










  







  
  

  
  
  

  
  

  
  
    
    <script src="/js/mathjax-config.js"></script>
  

  

  <link rel="stylesheet" href="/css/vendor-bundle.min.047268c6dd09ad74ba54a0ba71837064.css" media="print" onload="this.media='all'">

  
  
  
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.2/css/academicons.min.css" integrity="sha512-KlJCpRsLf+KKu2VQa5vmRuClRFjxc5lXO03ixZt82HZUk41+1I0bD8KBSA0fY290ayMfWYI9udIqeOWSu1/uZg==" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    
    
    
    
      
      
    
    
    

    
    
    

    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/instantsearch.css@7.4.5/themes/satellite-min.css" integrity="sha256-TehzF/2QvNKhGQrrNpoOb2Ck4iGZ1J/DI4pkd2oUsBc=" crossorigin="anonymous">
    

    
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      
      

      
      

      
    
      
      

      
      

      
    
  

  
  
  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.40c46424cda6c31a24080920b71731f4.css" />

  
  
  

  
  
  
  
  
  
  
    
    
    <link rel="stylesheet" href="/css/libs/chroma/github-light.min.css" title="hl-light" media="print" onload="this.media='all'" >
    <link rel="stylesheet" href="/css/libs/chroma/dracula.min.css" title="hl-dark" media="print" onload="this.media='all'" disabled>
  

  
  






<script async src="https://www.googletagmanager.com/gtag/js?id=G-EJKKXZT0QV"></script>
<script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
      dataLayer.push(arguments);
  }

  function trackOutboundLink(url, target) {
    gtag('event', 'click', {
         'event_category': 'outbound',
         'event_label': url,
         'transport_type': 'beacon',
         'event_callback': function () {
           if (target !== '_blank') {
             document.location = url;
           }
         }
    });
    console.debug("Outbound link clicked: " + url);
  }

  function onClickCallback(event) {
    if ((event.target.tagName !== 'A') || (event.target.host === window.location.host)) {
      return;
    }
    trackOutboundLink(event.target, event.target.getAttribute('target'));  
  }

  gtag('js', new Date());
  gtag('config', 'G-EJKKXZT0QV', {});
  gtag('set', {'cookie_flags': 'SameSite=None;Secure'});

  
  document.addEventListener('click', onClickCallback, false);
</script>























  
  
  






  <meta name="author" content="Young Geun Kim" />





  

<meta name="description" content="Introduction to change-point detection techniques. Focusing on univariate time series, we talk about both single and multiple changes in mean." />



<link rel="alternate" hreflang="en-us" href="https://ygeunkim.github.io/post/tscp/" />
<link rel="canonical" href="https://ygeunkim.github.io/post/tscp/" />



  <link rel="manifest" href="/manifest.webmanifest" />



<link rel="icon" type="image/png" href="/media/icon_hu0d7d4c4f88d467414214fd7d82de098f_200085_32x32_fill_lanczos_center_3.png" />
<link rel="apple-touch-icon" type="image/png" href="/media/icon_hu0d7d4c4f88d467414214fd7d82de098f_200085_180x180_fill_lanczos_center_3.png" />

<meta name="theme-color" content="#ff3860" />










  






<meta property="twitter:card" content="summary_large_image" />

  <meta property="twitter:site" content="@kim_younggeun" />
  <meta property="twitter:creator" content="@kim_younggeun" />
<meta property="twitter:image" content="https://ygeunkim.github.io/post/tscp/featured.jpg" />
<meta property="og:site_name" content="Young Geun Kim" />
<meta property="og:url" content="https://ygeunkim.github.io/post/tscp/" />
<meta property="og:title" content="Univariate Change Point Analysis | Young Geun Kim" />
<meta property="og:description" content="Introduction to change-point detection techniques. Focusing on univariate time series, we talk about both single and multiple changes in mean." /><meta property="og:image" content="https://ygeunkim.github.io/post/tscp/featured.jpg" /><meta property="og:locale" content="en-us" />

  
    <meta
      property="article:published_time"
      content="2022-04-26T00:00:00&#43;00:00"
    />
  
  
    <meta property="article:modified_time" content="2022-04-26T23:39:04&#43;09:00">
  






    






  




<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://ygeunkim.github.io/post/tscp/"
  },
  "headline": "Univariate Change Point Analysis",
  
  "image": [
    "https://ygeunkim.github.io/post/tscp/featured.jpg"
  ],
  
  "datePublished": "2022-04-26T00:00:00Z",
  "dateModified": "2022-04-26T23:39:04+09:00",
  
  "author": {
    "@type": "Person",
    "name": "Young Geun Kim"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "Young Geun Kim",
    "logo": {
      "@type": "ImageObject",
      "url": "https://ygeunkim.github.io/media/logo_huef44c54553e55ef916287ffc639d7a40_272316_192x192_fit_lanczos_3.png"
    }
  },
  "description": "Introduction to change-point detection techniques. Focusing on univariate time series, we talk about both single and multiple changes in mean."
}
</script>

  

  




  
  
  

  
  

  


  
  <title>Univariate Change Point Analysis | Young Geun Kim</title>

  
  
  
  











</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper   " data-wc-page-id="bbe03e2c31250e6691aa269ff7e72853" >

  
  
  
  
  
  
  
  
  
  <script src="/js/wowchemy-init.min.b7b2a24793f0ee9715c77789955c2f76.js"></script>

  


<aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#" aria-label="Close"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        
        
      </div>

      
      

      

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>



  <div class="page-header header--fixed">
  
  
  
  
  











  


<header>
  <nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
    <div class="container-xl">

      
      <div class="d-none d-lg-inline-flex">
        <a class="navbar-brand" href="/"><img src="/media/logo_huef44c54553e55ef916287ffc639d7a40_272316_0x70_resize_lanczos_3.png" alt="Young Geun Kim"
            
            ></a>
      </div>
      

      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar-content" aria-controls="navbar-content" aria-expanded="false" aria-label="Toggle navigation">
      <span><i class="fas fa-bars"></i></span>
      </button>
      

      
      <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
        <a class="navbar-brand" href="/"><img src="/media/logo_huef44c54553e55ef916287ffc639d7a40_272316_0x70_resize_lanczos_3.png" alt="Young Geun Kim"
          
          ></a>
      </div>
      

      
      
      <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

        
        <ul class="navbar-nav d-md-inline-flex">
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#about"><span>Home</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#featured"><span>Publications</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="/research/"><span>Research</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="/lab/"><span>Projects</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="/software/"><span>Software</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="/contact/"><span>About/Contact</span></a>
          </li>

          
          

        

          
        </ul>
      </div>

      <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

        
        
          
        

        
        
        
        <li class="nav-item">
          <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        
        
        
        <li class="nav-item dropdown theme-dropdown">
          <a href="#" class="nav-link" data-toggle="dropdown" aria-haspopup="true" aria-label="Display preferences">
            <i class="fas fa-moon" aria-hidden="true"></i>
          </a>
          <div class="dropdown-menu">
            <a href="#" class="dropdown-item js-set-theme-light">
              <span>Light</span>
            </a>
            <a href="#" class="dropdown-item js-set-theme-dark">
              <span>Dark</span>
            </a>
            <a href="#" class="dropdown-item js-set-theme-auto">
              <span>Automatic</span>
            </a>
          </div>
        </li>
        

        
        

      </ul>

    </div>
  </nav>
</header>


  </div>

  <div class="page-body">
    
    
    

    <article class="article">

  






















  
  


<div class="article-container pt-3">
  <h1>Univariate Change Point Analysis</h1>

  

  


<div class="article-metadata">

  
  
  
  
  <div>
    

  <span class="author-highlighted">
      <a href="/authors/admin/">Young Geun Kim</a></span>
  </div>
  
  

  
  <span class="article-date">
    
    
      
          Last updated on
      
    
    Apr 26, 2022
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    12 min read
  </span>
  

  
  
  
  

  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder mr-1"></i><a href="/category/post/">post</a></span>
  

</div>

  




<div class="btn-links mb-3">
  
  








  





<a href="#" class="btn btn-outline-primary btn-page-header js-cite-modal"
        data-filename="/post/tscp/cite.bib">
  Cite
</a>















</div>


</div>


<div class="article-header article-container featured-image-wrapper mt-4 mb-4" style="max-width: 720px; max-height: 480px;">
  <div style="position: relative">
    <img src="/post/tscp/featured_hu2e4e64d62d0ad1c4459bc4fc6300d941_3778764_720x2500_fit_q75_h2_lanczos.webp" width="720" height="480" alt="" class="featured-image">
    <span class="article-header-caption">Photo by <a href="https://unsplash.com/@m_____me" target="_blank" rel="noopener">m.</a> on <a href="https://unsplash.com/photos/ZzOa5G8hSPI" target="_blank" rel="noopener">Unsplash</a></span>
  </div>
</div>



  <div class="article-container">

    <div class="article-style">
      <!-- MathJax: start -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
      processEscapes: true
    }
  });
</script>
<script type="text/javascript"
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- MathJax: end -->
<!-- toc: start -->
<details>
<summary>
Table of Contents
</summary>
<ol>
<li><a href="#prob">Change Point Problem</a></li>
<li><a href="#single">Single Change Point</a>
<ol>
<li><a href="#lsedetect">LSE Change Point Detection</a></li>
<li><a href="#cusumest">Cumulative Sum (CUSUM) Estimator</a></li>
</ol>
</li>
<li><a href="#multiple">Multiple Change Pints</a>
<ol>
<li><a href="#binseg">Binary Segmentation</a></li>
<li><a href="#wildbinseg">Wild Binary Segmentation</a></li>
<li><a href="#mosumest">Moving Sum (MOSUM) Statistic and Tests</a></li>
</ol>
</li>
<li><a href="#wrap">Wrapping up</a></li>
</ol>
<ul>
<li><a href="#reflist">References</a></li>
</ul>
</details>
<!-- toc: end -->
<div class="alert alert-note">
  <div>
    Based on the lecture of Baek (<a href="#ref-sta5037">2020</a>) in <a href="https://www.skku.edu/eng/" target="_blank" rel="noopener">SKKU</a>
  </div>
</div>
<pre><code class="language-r"># tidyverse family---------------------------------
library(tidyverse)
# rolling arithmetics------------------------------
library(zoo)
# set seed for reproducibility---------------------
set.seed(1)
</code></pre>
<h1 id="a-nameprobachange-point-detection-problem"><a name='prob'></a>Change Point Detection Problem</h1>
<p>When analyzing time series, we often use parameter models to fit given dataset. In the sample from 2005 to 2006, for example, the chosen model might forecast well. Imagine, however, we should include 2007 to 2008 period in which financial crisis occurred. The estimators of the model would change due to this event😭. It is important to figure out these change points because the model parameter could change at the point. The goal of change point analysis is to mark the timestamp when some parameter has changed. Here the simplest setting is to detect change of the mean <code>\(\mu_t\)</code> in location model.</p>
<p><code>$$Y_t = \mu_t + \epsilon_t, \quad t = 1, \ldots, n$$</code></p>
<p>Then change point detection can be expressed by</p>
<p><code>$$H_0: \mu_1 = \cdots = \mu_n \quad \text{vs} \quad H_1: \exists k \colon \mu_1 = \cdots = \mu_k \neq \mu_{k + 1} = \cdots = \mu_n$$</code></p>
<p>Now, each method should</p>
<ol>
<li>Estimate unknown <code>\(k\)</code>.</li>
<li>Test.</li>
</ol>
<h1 id="a-namesingleasingle-change-point"><a name='single'></a>Single Change Point</h1>
<p>First consider single change point problem with <code>\(k = 100\)</code>.</p>
<pre><code class="language-r">y1 &lt;- tibble(key = &quot;a&quot;, value = rnorm(100, mean = 0), mean = 0)
y2 &lt;- tibble(key = &quot;b&quot;, value = rnorm(150, mean = 5), mean = 5)
# bind rows and bind time index column----------------
sim_single &lt;- 
  bind_rows(y1, y2) %&gt;% 
  mutate(index = 1:n())
</code></pre>
<iframe src="single_interactive.html" scrolling="no" seamless="seamless" frameBorder="0" width="90%" height="415.296"></iframe>
<ul>
<li>LSE</li>
<li>CUSUM (<a href="#ref-page1954">PAGE 1954</a>)</li>
</ul>
<p>These 2 methods can find one change point.</p>
<h2 id="a-namelsedetectalse-change-point-detection"><a name='lsedetect'></a>LSE Change Point Detection</h2>
<iframe src="point_single_interactive.html" scrolling="no" seamless="seamless" frameBorder="0" width="90%" height="415.296"></iframe>
<p>Above figure just changes time plot to point. To estimate <code>\(k\)</code>, the most easiest way is to minimize sum of within sums of square.</p>
<p>Let</p>
<p><code>\(\overline{Y}_k = \frac{1}{k} \sum_{t = 1}^k Y_t\)</code> and let <code>\(\overline{Y}_k^\ast = \frac{1}{n - k} \sum_{t = k + 1}^n Y_t\)</code>. Then</p>
<p><code>$$\begin{aligned}   \hat{k}^{LS} &amp; = \arg\min_{1 \le k \le n - 1} \left( \sum_{t = 1}^k (Y_t - \overline{Y}_k)^2 + \sum_{t = k + 1}^n (Y_t - \overline{Y}_k^\ast)^2 \right) \\   &amp; = \arg\max_{1 \le k \le n - 1} \sqrt{\frac{k (n - k)}{n}} \left\lvert \overline{Y}_k - \overline{Y}_k^\ast \right\rvert \end{aligned}$$</code></p>
<p>Observe that by multiplying <code>\(\sqrt{\frac{k (n - k)}{n}}\)</code>, it adjusts the location of <code>\(k\)</code> and the sample size. You can see this feature in the following figure.</p>
<pre><code class="language-r">lse_output &lt;- 
  sim_single %&gt;% 
  mutate(
    mean_k = cumsum(value) / index,
    mean_ast = sapply(
      index + 1, function(i) {
        sum(value[i:n()])
      }
    ) / (n() - index),
    lse_unadjust = abs(mean_k - mean_ast),
    lse_adjust = sqrt(index * (n() - index) / n()) * lse_unadjust
  )
</code></pre>
<iframe src="lse_interactive.html" scrolling="no" seamless="seamless" frameBorder="0" width="90%" height="415.296"></iframe>
<p>While LSE estimator performs well, unadjusted LSE inflates against <code>\(k\)</code>.</p>
<h2 id="a-namecusumestacumulative-sum-cusum-estimator"><a name='cusumest'></a>Cumulative Sum (CUSUM) Estimator</h2>
<p>This method is called CUSUM because it deals with cumulative sum (of <code>\(Y_t - \overline{Y}\)</code> until <code>\(k\)</code>) as follows.</p>
<p><code>$$\begin{aligned}   \left\lvert \chi(k) \right\rvert &amp; = \frac{1}{\sqrt{n}} \left\lvert \sum_{t = 1}^k Y_t - \frac{k}{n} \sum_{t = 1}^n Y_t \right\rvert \\     &amp; = \frac{1}{\sqrt{n}} \left\lvert \sum_{t = 1}^k (Y_t - \overline{Y}) \right\rvert \end{aligned}$$</code></p>
<p>where <code>\(\overline{Y} = \frac{1}{n} \sum_{t = 1}^n Y_t\)</code>. In turn, we estimate <code>\(k\)</code> by <em>maximizing the CUSUM</em>.</p>
<p><code>$$\hat{k}^{CUSUM} = \arg\max_{1 \le k \le n} \left\lvert \chi(k) \right\rvert$$</code></p>
<p>In fact, CUSUM inspect the absolute difference between <code>\(\overline{Y}_k\)</code> and <code>\(\overline{Y}_k^\ast\)</code>, i.e.</p>
<p><code>$$\lvert \chi(k) \rvert = \frac{1}{\sqrt{n}} \frac{k (n - k)}{n} \left\lvert \overline{Y}_k - \overline{Y}_k^\ast \right\rvert$$</code></p>
<p>It follows that CUSUM change point estimator is <em>also an LSE estimator</em> in that</p>
<p><code>$$\begin{aligned}   \hat{k}^{LS} &amp; = \arg\max_{1 \le k \le n - 1} \sqrt{\frac{k (n - k)}{n}} \left\lvert \overline{Y}_k - \overline{Y}_k^\ast \right\rvert \\   &amp; = \arg\max_{1 \le k \le n - 1} \sqrt{\frac{n}{k (n - k)}} \left\lvert \chi(k) \right\rvert \\   &amp; = \arg\max_{1 \le k \le n - 1} \left\lvert \widetilde\chi(k) \right\rvert \end{aligned}$$</code></p>
<p>where <code>\(\left\lvert \widetilde\chi(k) \right\rvert\)</code> is adjusted CUSUM defined by <code>\(\left\lvert \widetilde\chi(k) \right\rvert = \sqrt{\frac{n}{k (n - k)}} \lvert \chi(k) \rvert\)</code>.</p>
<pre><code class="language-r">cusum_output &lt;- 
  sim_single %&gt;% 
  mutate(
    ave = mean(value),
    cusum = abs(cumsum(value - ave)) / sqrt(n())
  )
</code></pre>
<p>We can easily find the value which maximizes CUSUM😀. See the trajectory of CUSUM figure. Its maximum stands out.</p>
<iframe src="cusum_interactive.html" scrolling="no" seamless="seamless" frameBorder="0" width="90%" height="415.296"></iframe>
<p>The second step is test. For this testing, we investigate some theory. As in the <a href="#prob">first Section</a>, we test null hypothesis of no change point that <code>\(H_0: \mu_1 = \cdots = \mu_n\)</code> versus <em>single change point existence</em>. Given each <code>\(\hat{k}\)</code>, we build test statistic and derive its (asymptotic) distribution. Under <code>\(H_0\)</code>, functional central limit theorem holds under some conditions (see the tables below). Let <code>\(B(t)\)</code> is a <a href="https://en.wikipedia.org/wiki/Brownian_bridge" target="_blank" rel="noopener">Brownian bridge</a> (standard Brownian motion) and let <code>\(\sigma^2\)</code> be the long-run variance. The different part is scaling <code>\(\sqrt{u (1 - u)}\)</code> for sample size. Multiplying unbalance against sample size raises precision of <code>\(\hat{k}^{LS}\)</code>, but it makes difficult to get p-value of <code>\(T_{LS}\)</code>.</p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">LSE</th>
<th style="text-align:center">CUSUM</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Statistic</td>
<td style="text-align:center">$T_{LS} = \max_{1 \le k \le n - 1} \left\lvert \widetilde\chi(k) \right\rvert$</td>
<td style="text-align:center">$T_{CUSUM} = \max_{1 \le k \le n} \left\lvert \chi(k) \right\rvert$</td>
</tr>
<tr>
<td style="text-align:center">Distribution</td>
<td style="text-align:center">$T_{LS} \stackrel{\cal{D}}{\rightarrow} \sigma \sup_{0 \le u \le 1} \frac{\left\lvert B(u) \right\rvert}{\sqrt{u (1 - u)}}$</td>
<td style="text-align:center">$T_{CUSUM} \stackrel{\cal{D}}{\rightarrow} \sigma \sup_{0 \le u \le 1} \left\lvert B(u) \right\rvert$</td>
</tr>
<tr>
<td style="text-align:center">p-value (computation)</td>
<td style="text-align:center">hard</td>
<td style="text-align:center">easy</td>
</tr>
<tr>
<td style="text-align:center">$\hat{k}$</td>
<td style="text-align:center">precision good</td>
<td style="text-align:center">bias bad</td>
</tr>
</tbody>
</table>
<h1 id="a-namemultipleamultiple-change-points"><a name='multiple'></a>Multiple Change Points</h1>
<p>Consider 3 change points: <code>\(k_1 = 100\)</code>, <code>\(k_2 = 250\)</code>, and <code>\(k_3 = 300\)</code>.</p>
<pre><code class="language-r">y1 &lt;- tibble(key = &quot;a&quot;, value = rnorm(100, mean = 0), mean = 0)
y2 &lt;- tibble(key = &quot;b&quot;, value = rnorm(150, mean = 3), mean = 3)
y3 &lt;- tibble(key = &quot;c&quot;, value = rnorm(50, mean = -1), mean = -1)
y4 &lt;- tibble(key = &quot;d&quot;, value = rnorm(50, mean = 1), mean = 1)
# bind rows and bind time index column----------------
sim_multiple &lt;- 
  bind_rows(y1, y2, y3, y4) %&gt;% 
  mutate(index = 1:n())
</code></pre>
<iframe src="multi_interactive.html" scrolling="no" seamless="seamless" frameBorder="0" width="90%" height="415.296"></iframe>
<p>In multiple change points problem, we do not know both location and the number of of <code>\(k\)</code>’s. In single change point problem, alternative hypothesis was literally the existence of one single point. Now, we should extend this hypothesis to <em>at least one change point</em>. Based on above CUSUM statistic detection, we introduce the following methods. Of course there are the other advanced detection methods, this post focus on simple approach in location model.</p>
<ul>
<li>Binary segmentation (<a href="#ref-vostrikova1981detecting">Vostrikova 1981</a>)</li>
<li>Wild binary segmentation (<a href="#ref-Fryzlewicz.2014">Fryzlewicz 2014</a>)</li>
<li>MOSUM (<a href="#ref-Eichinger.2018">Eichinger and Kirch 2018</a>)</li>
</ul>
<h2 id="a-namebinsegabinary-segmentation"><a name='binseg'></a>Binary Segmentation</h2>
<p>Binary segmentation suggested by Vostrikova (<a href="#ref-vostrikova1981detecting">1981</a>) is famous with its effective computation. This is basic algorithm, so it is also called standard binary segmentation (SBS). It performs single detection by top-down way. This helps computation cheap. Fryzlewicz (<a href="#ref-Fryzlewicz.2014">2014</a>) provides well-organized pseudocode (section 3.2).<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup></p>
<p>















<figure  id="figure-top-down-method">
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img src="/media/binseg.png" alt="binseg-fig" loading="lazy" data-zoomable /></div>
  </div><figcaption>
      Top Down method
    </figcaption></figure>
</p>
<p>SBS cuts the entire sample <code>\(\{ y_t \mathpunct{:} t = 1, \ldots n \}\)</code> with change point. In turn, it explores each part thoroughly. In the algorithm, we can find CUSUM in single stick by means of detecting change point, respectively.</p>
<pre><code class="language-r">find_binseg &lt;- function(data, s = 0, e) {
  cusum_out &lt;- 
    data %&gt;% 
    dplyr::filter(index &gt; s, index &lt;= e) %&gt;% 
    mutate(
      ave = mean(value),
      cusum = abs(cumsum(value - ave)) / sqrt(n())
    ) %&gt;% 
    filter(cusum == max(cusum))
  list(
    stat = cusum_out$cusum,
    change_point = cusum_out$index
  )
}
</code></pre>
<p>First, we find <code>\(k = 250\)</code>:</p>
<pre><code class="language-r">(binseg1 &lt;- find_binseg(sim_multiple, 0, nrow(sim_multiple)))
#&gt; $stat
#&gt; [1] 7.13
#&gt; 
#&gt; $change_point
#&gt; [1] 250
</code></pre>
<p>Next, see before and after <code>\(k = 250\)</code>:</p>
<pre><code class="language-r">find_binseg(sim_multiple, 0, 250)
#&gt; $stat
#&gt; [1] 10.9
#&gt; 
#&gt; $change_point
#&gt; [1] 99
find_binseg(sim_multiple, 251, nrow(sim_multiple))
#&gt; $stat
#&gt; [1] 5.06
#&gt; 
#&gt; $change_point
#&gt; [1] 300
</code></pre>
<p>Both statistics seems large, so we say these two points are change points.</p>
<pre><code class="language-r">find_binseg(sim_multiple, 0, 100)
#&gt; $stat
#&gt; [1] 0.506
#&gt; 
#&gt; $change_point
#&gt; [1] 73
find_binseg(sim_multiple, 100, 250)
#&gt; $stat
#&gt; [1] 0.755
#&gt; 
#&gt; $change_point
#&gt; [1] 209
</code></pre>
<p>Every statistic is small, so we stop here. Consider the last block, after <code>250</code>. Following figure computes CUSUM in multiple change points setting. Recall that it is expected to be huge at the change point. In first two breaks, the estimators seem works okay. However, it does not at the last. Why?</p>
<iframe src="mcusum_interactive.html" scrolling="no" seamless="seamless" frameBorder="0" width="90%" height="415.296"></iframe>
<p>Observe their true mean from the simulation step:</p>
<pre><code>#&gt; [1]  0  3 -1  1
</code></pre>
<p>We can expect that <code>-1</code> and <code>1</code> were canceled. In the above figure, blue line is calculating CUSUM only in this area. The estimator looks like working better. In this example, binary segmentation could find <code>300</code> as change point since this block came at once after <code>\(k = 250\)</code> was found. SBS, however, is <em>not guaranteed to include this specific local range</em> since the process of detection is not predictable.</p>
<p>Fryzlewicz (<a href="#ref-Fryzlewicz.2014">2014</a>) suggested <em>randomly splitted localization</em> as the solution. It is called Wild binary segmentation (WBS).</p>
<h2 id="a-namewildbinsegawild-binary-segmentation"><a name='wildbinseg'></a>Wild Binary Segmentation</h2>
<p>Wild Binary Segmentation (WBS) is bootstrap version for binary segmentation. It chooses random interval <code>\([s_m, e_m]\)</code> ($m = 1, \ldots M$) in each step. Moreover, the reason this technique is related to bootstrap is <code>\(s_m &lt; e_m\)</code> are <em>sampled with replacement</em>. For instance:</p>
<pre><code class="language-r">boot_size &lt;- 10
# sampling with replacement--------------------
boot_eg &lt;- 
  matrix(
    sample(sim_multiple$index, size = boot_size * 2, replace = TRUE), 
    nrow = 2, 
    ncol = boot_size
  ) %&gt;% 
  apply(2, sort)
# rownames-------------------------------------
rownames(boot_eg) &lt;- c(&quot;sm&quot;, &quot;em&quot;)
boot_eg
#&gt;    [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]
#&gt; sm   88  199   22  118   52  118  294   77  113   114
#&gt; em  251  254  312  186  311  183  347  185  268   192
</code></pre>
<p>WBS also begins with the entire sequence as SBS does. However, it should get statistic maximum and change point for each bootstrap interval. Among them, the interval whose maxima is the largest.</p>
<p>















<figure  id="figure-wbs-algorithm-illustration">
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img src="/media/wbs.png" alt="wbs-fig" loading="lazy" data-zoomable /></div>
  </div><figcaption>
      WBS Algorithm Illustration
    </figcaption></figure>
</p>
<p>Fryzlewicz (<a href="#ref-Fryzlewicz.2014">2014</a>) provides algorithms of the wild binary segmentation (section 3.3). In this post, we follow the step as in <a href="#binseg">previous section</a> to help understand the whole procedure.</p>
<p>For the entire sequence (bootstrap size <code>100</code>):</p>
<pre><code class="language-r"># bootstrap----------------------------
boot1 &lt;- 
  matrix(
    sample(sim_multiple$index, size = 100 * 2, replace = TRUE), 
    nrow = 2, 
    ncol = 100
  ) %&gt;% 
  apply(2, sort)
# WBS----------------------------------
wbs1 &lt;- 
  boot1 %&gt;% 
  apply(2, function(x) {find_binseg(data = sim_multiple, s = x[1], e = x[2])})
</code></pre>
<iframe src="wbs1_interactive.html" scrolling="no" seamless="seamless" frameBorder="0" width="90%" height="415.296"></iframe>
<p>Among 100 intervals, <code>250</code> gives the maximum CUSUM statistic. Next step, before <code>250</code>:</p>
<pre><code class="language-r"># bootstrap----------------------------
boot2 &lt;- 
  matrix(
    sample(1:250, size = 100 * 2, replace = TRUE), 
    nrow = 2, 
    ncol = 100
  ) %&gt;% 
  apply(2, sort)
# WBS----------------------------------
wbs2 &lt;- 
  boot2 %&gt;% 
  apply(2, function(x) {find_binseg(data = sim_multiple, s = x[1], e = x[2])})
</code></pre>
<p>After <code>250</code>:</p>
<pre><code class="language-r"># bootstrap----------------------------
boot3 &lt;- 
  matrix(
    sample(251:last(sim_multiple$index), size = 100 * 2, replace = TRUE), 
    nrow = 2, 
    ncol = 100
  ) %&gt;% 
  apply(2, sort)
# WBS----------------------------------
wbs3 &lt;- 
  boot3 %&gt;% 
  apply(2, function(x) {find_binseg(data = sim_multiple, s = x[1], e = x[2])})
</code></pre>
<iframe src="wbs23_interactive.html" scrolling="no" seamless="seamless" frameBorder="0" width="90%" height="415.296"></iframe>
<p>Choose the point with the highest value in each color. Denote that they are similar to the true ones 👍🏼.</p>
<h2 id="a-namemosumestamoving-sum-mosum-statistic-and-tests"><a name='mosumest'></a>Moving Sum (MOSUM) Statistic and Tests</h2>
<p>As we have seen above, localization of CUSUM can improve performance. MOSUM is localization of CUSUM statistic of window size <code>\(G\)</code> (<a href="#ref-Eichinger.2018">Eichinger and Kirch 2018</a>). In each window, moving sum is computed.</p>
<p><code>$$\left\lvert T_{k, n}(G) \right\rvert = \frac{1}{\sqrt{2 G}} \left\lvert \sum_{t = k + 1}^{k + G} Y_t - \sum_{t = k - G + 1}^k Y_t \right\rvert$$</code></p>
<pre><code class="language-r">mosum_output &lt;- 
  sim_multiple %&gt;% 
  mutate(
    roll_mean = rollsum(value, k = 20, na.pad = TRUE, align = &quot;right&quot;),
    mosum = abs(lead(roll_mean, n = 20) - roll_mean) / sqrt(2 * 20)
  )
</code></pre>
<p>Unlike CUSUM, MOSUM is detecting the last change point by localization.</p>
<iframe src="mosum_interactive.html" scrolling="no" seamless="seamless" frameBorder="0" width="90%" height="415.296"></iframe>
<p>The next step is similar to CUSUM or the other statistic.</p>
<p><code>$$T_n(G) = \max_{G \le k \le n - G} \frac{\left\lvert T_{k, n}(G) \right\rvert}{\sigma}$$</code></p>
<p>with long-run variance <code>\(\sigma\)</code>. Now we can see additional topics to solve:</p>
<ol>
<li>Estimate long-run variance</li>
<li>and choose the bandwidth.</li>
</ol>
<p>Let <code>\(q = q_n\)</code> be the number of changes and let <code>\(k_1 &lt; k_2 &lt; \cdots &lt; k_q\)</code> be each change point. Then the <em>null hypothesis of no change point</em> can be represented by</p>
<p><code>$$H_0: q_n = 0$$</code></p>
<p>versus alternative hypothesis of at least one change</p>
<p><code>$$H_1: q_n \ge 1$$</code></p>
<p>Recall that CUSUM converges in distribution to Brownian bridge. This enables the computation of p-value.
Also in MOSUM framework, some asymptotic theorem holds. Under above null hypothesis, <code>\(T_n(G)\)</code> can use the distribution Gumbel extreme value distribution asymptotically. The form is quite complex, so we skip the details in this post. Please see <strong>Theorem 2.1</strong> of Eichinger and Kirch (<a href="#ref-Eichinger.2018">2018</a>) 😱.</p>
<h3 id="variance">Variance</h3>
<p>Now, we estimate long-run variance in each break instead of sample variance <code>\(\hat\sigma^2 = \frac{1}{n - 1}\sum_{t = 1}^n (Y_t - \overline{Y})^2\)</code>. Assuming <em>i.i.d. errors</em>, implementing the sample variance formula is suggested. Let <code>\(\overline{Y}_{k - G + 1, k} = \frac{1}{G} \sum_{t = k - G + 1}^k Y_t\)</code> be the sample mean of <code>\(G\)</code> points before <code>\(k\)</code> and let <code>\(\overline{Y}_{k + 1, k + G} = \frac{1}{G} \sum_{t = k + 1}^{k + G} Y_t\)</code> be the sample mean of <code>\(G\)</code> points after <code>\(k\)</code>. Eichinger and Kirch (<a href="#ref-Eichinger.2018">2018</a>) computed sample variance in this window of <code>\(k\)</code>-th point:</p>
<p><code>$$\hat\sigma_{k, n}^2 = \frac{1}{2G} \left( \sum_{t = k - G + 1}^k (Y_t - \overline{Y}_{k - G + 1, k})^2 + \sum_{t = k + 1}^{k + G} (Y_t - \overline{Y}_{k + 1, k + G})^2 \right)$$</code></p>
<pre><code class="language-r">mosum_var &lt;- 
  sim_multiple %&gt;% 
  mutate(
    roll_mean = rollsum(value, k = 20, na.pad = TRUE, align = &quot;right&quot;),
    mosum = abs(lead(roll_mean, n = 20) - roll_mean) / sqrt(2 * 20),
    roll_var = 
      (rollapply(value, width = 20, var, fill = NA, align = &quot;right&quot;) * 19 + 
         rollapply(value, width = 20, var, fill = NA, align = &quot;left&quot;) * 19) / 40,
    mosum_est = mosum / sqrt(roll_var)
  )
</code></pre>
<p>The following shows MOSUM statistic <code>\(\hat\sigma_{k, n}^{-1} \left\lvert T_{k, n}(G) \right\rvert\)</code>. By multiplying standard deviation to the sum, now we can detect change point more clearly.</p>
<iframe src="mosumest_interactive.html" scrolling="no" seamless="seamless" frameBorder="0" width="90%" height="415.296"></iframe>
<h3 id="bandwidth-selection">Bandwidth Selection</h3>
<p>Try <code>\(G = 5, 10, 20, 40, 45\)</code>. One of many assumptions in the paper of Eichinger and Kirch (<a href="#ref-Eichinger.2018">2018</a>) is that the window size <code>\(2G\)</code> should be large enough (Assumption A.2). The figure below is MOSUM statistic for each bandwidth. When <code>\(G = 3, 5\)</code>, i.e. the <em>bandwidth is small, you can see it is not easy to find maximum</em> of the statistic. <em>In large bandwidth, the maximum points stand out</em>.</p>
<iframe src="mosumgrid_interactive.html" scrolling="no" seamless="seamless" frameBorder="0" width="90%" height="415.296"></iframe>
<h1 id="a-namewrapawrapping-up"><a name='wrap'></a>Wrapping up</h1>
<p>We have covered change point analysis for univariate time series. Codes I have written are absolutely not practical. In fact, many researchers already developed useful packages for this topic. Later, I plan to write a post about detecting change point using <code>R</code> (of course, using CRAN packages 🤗).</p>
<hr>
<h1 id="a-namereflistareferences"><a name='reflist'></a>References</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-sta5037" class="csl-entry">
<p>Baek, Changryong. 2020. “Recent Advances in Applied Statistics (Sta5037).” Department of Statistics, Sungkyunkwan University; <a href="https://sites.google.com/view/crbaek" target="_blank" rel="noopener">https://sites.google.com/view/crbaek</a>.</p>
</div>
<div id="ref-Eichinger.2018" class="csl-entry">
<p>Eichinger, Birte, and Claudia Kirch. 2018. “<span class="nocase">A MOSUM procedure for the estimation of multiple random change points</span>.” <em>Bernoulli</em> 24 (1): 526–64. <a href="https://doi.org/10.3150/16-bej887" target="_blank" rel="noopener">https://doi.org/10.3150/16-bej887</a>.</p>
</div>
<div id="ref-Fryzlewicz.2014" class="csl-entry">
<p>Fryzlewicz, Piotr. 2014. “<span class="nocase">Wild binary segmentation for multiple change-point detection</span>.” <em>The Annals of Statistics</em> 42 (6): 2243–81. <a href="https://doi.org/10.1214/14-aos1245" target="_blank" rel="noopener">https://doi.org/10.1214/14-aos1245</a>.</p>
</div>
<div id="ref-page1954" class="csl-entry">
<p>PAGE, E. S. 1954. “CONTINUOUS INSPECTION SCHEMES.” <em>Biometrika</em> 41 (1-2): 100–115. <a href="https://doi.org/10.1093/biomet/41.1-2.100" target="_blank" rel="noopener">https://doi.org/10.1093/biomet/41.1-2.100</a>.</p>
</div>
<div id="ref-vostrikova1981detecting" class="csl-entry">
<p>Vostrikova, Lyudmila Yur’evna. 1981. “Detecting ‘Disorder’ in Multidimensional Random Processes.” In <em>Doklady Akademii Nauk</em>, 259:270–74. 2. Russian Academy of Sciences.</p>
</div>
</div>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p>Please read the article if you are interested 😎&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>

    </div>

    





<div class="article-tags">
  
  <a class="badge badge-light" href="/tag/change-point-analysis/">change-point-analysis</a>
  
  <a class="badge badge-light" href="/tag/time-series/">time-series</a>
  
</div>



<div class="share-box">
  <ul class="share">
    
      
      
      
        
      
      
      
      
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fygeunkim.github.io%2Fpost%2Ftscp%2F&amp;text=Univariate&#43;Change&#43;Point&#43;Analysis" target="_blank" rel="noopener" class="share-btn-twitter" aria-label="twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fygeunkim.github.io%2Fpost%2Ftscp%2F&amp;t=Univariate&#43;Change&#43;Point&#43;Analysis" target="_blank" rel="noopener" class="share-btn-facebook" aria-label="facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      
      
      
      
        
      
      <li>
        <a href="mailto:?subject=Univariate%20Change%20Point%20Analysis&amp;body=https%3A%2F%2Fygeunkim.github.io%2Fpost%2Ftscp%2F" target="_blank" rel="noopener" class="share-btn-email" aria-label="envelope">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=https%3A%2F%2Fygeunkim.github.io%2Fpost%2Ftscp%2F&amp;title=Univariate&#43;Change&#43;Point&#43;Analysis" target="_blank" rel="noopener" class="share-btn-linkedin" aria-label="linkedin-in">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      
      
      
      
      <li>
        <a href="whatsapp://send?text=Univariate&#43;Change&#43;Point&#43;Analysis%20https%3A%2F%2Fygeunkim.github.io%2Fpost%2Ftscp%2F" target="_blank" rel="noopener" class="share-btn-whatsapp" aria-label="whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=https%3A%2F%2Fygeunkim.github.io%2Fpost%2Ftscp%2F&amp;title=Univariate&#43;Change&#43;Point&#43;Analysis" target="_blank" rel="noopener" class="share-btn-weibo" aria-label="weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>











  
  
    



  
  
  
    
  
  
  
  <div class="media author-card content-widget-hr">
    
      
      <a href="https://ygeunkim.github.io/"><img class="avatar mr-3 avatar-circle" src="/authors/admin/avatar_hucc980f41d44546dfe8dc45f5e262aa9b_3342578_270x270_fill_lanczos_center_3.png" alt="Young Geun Kim"></a>
    

    <div class="media-body">
      <h5 class="card-title"><a href="https://ygeunkim.github.io/">Young Geun Kim</a></h5>
      <h6 class="card-subtitle">Ph.D. Candidate in Department of Statistics</h6>
      <p class="card-text">Researching long-range dependent time series, Bayesian econometrics, and time series deep learning models.</p>
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
    <li>
      <a href="mailto:ygeunkimstat@gmail.com" >
        <i class="fas fa-paper-plane"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/ygeunkim" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="https://scholar.google.com/citations?user=q-NdjAoAAAAJ" target="_blank" rel="noopener">
        <i class="ai ai-google-scholar"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="/younggeun-cv.pdf" >
        <i class="ai ai-cv"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>


  







  
  
  

  

  










  </div>
</article>
  </div>

  <div class="page-footer">
    
    
    <div class="container">
      <footer class="site-footer">

  












  
  
  
  
  













  
  
  

  
  
    
  
  
    
  

  

  
  <p class="powered-by copyright-license-text">
    © 2023 Me. This work is licensed under <a href="https://creativecommons.org/licenses/by-nc-nd/4.0" rel="noopener noreferrer" target="_blank">CC BY NC ND 4.0</a>
  </p>
  

  <p class="powered-by footer-license-icons">
    <a href="https://creativecommons.org/licenses/by-nc-nd/4.0" rel="noopener noreferrer" target="_blank" aria-label="Creative Commons">
      <i class="fab fa-creative-commons fa-2x" aria-hidden="true"></i>
      <i class="fab fa-creative-commons-by fa-2x" aria-hidden="true"></i>
      
        <i class="fab fa-creative-commons-nc fa-2x" aria-hidden="true"></i>
      
      
        <i class="fab fa-creative-commons-nd fa-2x" aria-hidden="true"></i>
      
    </a>
  </p>





  <p class="powered-by">
    
    
    
      
      
      
      
      
      
      Published with <a href="https://wowchemy.com/?utm_campaign=poweredby" target="_blank" rel="noopener">Wowchemy</a> — the free, <a href="https://github.com/wowchemy/wowchemy-hugo-themes" target="_blank" rel="noopener">open source</a> website builder that empowers creators.
    
  </p>
</footer>

    </div>
    
  </div>

  


<script src="/js/vendor-bundle.min.f64289d8217e08e3afcd597d60836062.js"></script>




  

  
  

  













  
  <script id="search-hit-algolia-template" type="text/html">
    <div class="search-hit">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{#helpers.highlight}}{ "attribute": "title" }{{/helpers.highlight}}</a>
        </div>
        <div class="article-metadata search-hit-type">{{type}}</div>
        <p class="search-hit-description">{{#helpers.highlight}}{ "attribute": "summary" }{{/helpers.highlight}}</p>
      </div>
    </div>
  </script>
  
    <script src="https://cdn.jsdelivr.net/npm/instantsearch.js@4/dist/instantsearch.production.min.js" crossorigin="anonymous"></script>
  
  












  
  
  
  
  
  
  



<script src="/en/js/algolia-search-built.min.a83b67888a214405d3d5635e17ab780b.js" type="module"></script>





<script id="page-data" type="application/json">{"use_headroom":true}</script>



  <script src="/js/wowchemy-headroom.db4755770454eb63685f8de785c0a172.js" type="module"></script>










<script src="/en/js/wowchemy.min.31ab68bbd55a143f42cc7c744c451560.js"></script>







  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        
        <pre><code></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>


  <script src="/js/wowchemy-publication.68f8d7090562ca65fc6d3cb3f8f2d2cb.js" type="module"></script>




  
<script type="text/javascript" src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script>


<script async src="https://badge.dimensions.ai/badge.js" charset="utf-8"></script>


<script type="text/javascript" src="https://cdn.plu.mx/widget-popup.js"></script>















</body>
</html>
